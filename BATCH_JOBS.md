# ë°°ì¹˜ ì‘ì—… ëª©ë¡ ë° ìŠ¤ì¼€ì¤„

> SKALA Physical Risk AI ModelOps í”Œë«í¼ì˜ ëª¨ë“  ë°°ì¹˜ ì‘ì—… ì •ë¦¬

ìµœì¢… ìˆ˜ì •ì¼: 2025-12-19
ë²„ì „: v1.0

---

## ğŸ“‹ ëª©ì°¨

- [ë°°ì¹˜ ì‘ì—… ê°œìš”](#ë°°ì¹˜-ì‘ì—…-ê°œìš”)
- [ìë™ ìŠ¤ì¼€ì¤„ ë°°ì¹˜](#ìë™-ìŠ¤ì¼€ì¤„-ë°°ì¹˜)
- [On-Demand API ë°°ì¹˜](#on-demand-api-ë°°ì¹˜)
- [ë°°ì¹˜ ì‘ì—… ëª¨ë‹ˆí„°ë§](#ë°°ì¹˜-ì‘ì—…-ëª¨ë‹ˆí„°ë§)

---

## ë°°ì¹˜ ì‘ì—… ê°œìš”

ë³¸ ì‹œìŠ¤í…œì—ì„œ ìš´ì˜ ì¤‘ì¸ ë°°ì¹˜ ì‘ì—…ì€ í¬ê²Œ ë‘ ê°€ì§€ë¡œ ë¶„ë¥˜ë©ë‹ˆë‹¤:

1. **ìë™ ìŠ¤ì¼€ì¤„ ë°°ì¹˜**: ì •ê¸°ì ìœ¼ë¡œ ìë™ ì‹¤í–‰ë˜ëŠ” ë°°ì¹˜ (APScheduler, Cron)
2. **On-Demand API ë°°ì¹˜**: ì‚¬ìš©ì ìš”ì²­ ì‹œ ì‹¤í–‰ë˜ëŠ” ë°±ê·¸ë¼ìš´ë“œ ë°°ì¹˜ (FastAPI BackgroundTasks)

---

## ìë™ ìŠ¤ì¼€ì¤„ ë°°ì¹˜

### ë°°ì¹˜ ì‘ì—… ëª©ë¡

| ë°°ì¹˜ ì‘ì—…ëª… | ì‹¤í–‰ ì£¼ê¸° | ì‹¤í–‰ ì‹œê°„ | ë‹´ë‹¹ ì„œë¹„ìŠ¤ | ì„¤ëª… |
|------------|----------|----------|------------|------|
| **Probability ê³„ì‚°** | ë§¤ì›” 1ì¼ | ìƒˆë²½ 2ì‹œ (02:00 KST) | ModelOps | 451,351ê°œ ê·¸ë¦¬ë“œ Ã— 9ê°œ ì¬í•´ ìœ í˜•ì˜ í™•ë¥  ê³„ì‚° (ì•½ 12-15ì‹œê°„ ì†Œìš”) |
| **Hazard Score ê³„ì‚°** | ë§¤ì›” 1ì¼ | ìƒˆë²½ 4ì‹œ (04:00 KST) | ModelOps | Probability ê³„ì‚° ì™„ë£Œ í›„ ìë™ ì‹¤í–‰ë˜ëŠ” ìœ„í—˜ë„ ì ìˆ˜ ê³„ì‚° |
| **ì¬ë‚œì•ˆì „ë°ì´í„° ETL** | ë§¤ì¼ | ì˜¤ì „ 9ì‹œ (09:00 KST) | ModelOps | ê¸´ê¸‰ì¬ë‚œë¬¸ì API ìˆ˜ì§‘ ë° DB ì ì¬ (9ì¢… ì¬ë‚œ ìœ í˜•, ìµœê·¼ 5ë…„ ë°ì´í„°) |
| **ESG Trends Agent** | ì£¼ 2íšŒ | ì›”ìš”ì¼, ëª©ìš”ì¼ 09:00 KST | ModelOps | ê¸°í›„ ê´€ë ¨ ë‰´ìŠ¤ ìˆ˜ì§‘ ë° GPT-4o-mini ë¶„ì„ í›„ Slack ì•Œë¦¼ ë°œì†¡ |
| **ì‚¬ì—…ì¥ ë¦¬ìŠ¤í¬ ê³„ì‚°** | On-Demand | API ìš”ì²­ ì‹œ | ModelOps | Nê°œ ì‚¬ì—…ì¥ Ã— 4ê°œ ì‹œë‚˜ë¦¬ì˜¤ Ã— 80ê°œ ì—°ë„ Ã— 9ê°œ ë¦¬ìŠ¤í¬ íƒ€ì…ì˜ E, V, AAL ê³„ì‚° (ë³‘ë ¬ ì²˜ë¦¬, max_workers=8) |
| **ì‚¬ì—…ì¥ ì´ì „ í›„ë³´ì§€ ì¶”ì²œ** | On-Demand | API ìš”ì²­ ì‹œ | ModelOps | Nê°œ ì‚¬ì—…ì¥ Ã— Mê°œ í›„ë³´ì§€ì˜ í†µí•© ë¦¬ìŠ¤í¬ í‰ê°€ ë° ì¶”ì²œ (Early Callback ìµœì í™”, max_workers=8) |
| **ì„œë²„ ìƒíƒœ ë³´ê³ ** | ë§¤ì¼ | ì˜¤ì „ 8ì‹œ (08:00 KST) | server-monitor | ì „ì¼ ì„œë²„ ë¦¬ì†ŒìŠ¤ ì‚¬ìš© í˜„í™© ì´ë©”ì¼ ë¦¬í¬íŠ¸ ìƒì„± |
| **ì„œë²„ ë¦¬ì†ŒìŠ¤ ëª¨ë‹ˆí„°ë§** | 1ë¶„ë§ˆë‹¤ | ì—°ì† ì‹¤í–‰ | server-monitor | CPU/Memory/Disk ì‚¬ìš©ë¥  80% ì´ˆê³¼ ì‹œ ì´ë©”ì¼ ì•Œë¦¼ (6ì‹œê°„ë§ˆë‹¤ ì¬ì•Œë¦¼) |

---

## 1. Probability ê³„ì‚° ë°°ì¹˜

### ê¸°ë³¸ ì •ë³´

- **ë°°ì¹˜ ID**: `probability_batch`
- **ì‹¤í–‰ ì£¼ê¸°**: ë§¤ì›” 1ì¼ ìƒˆë²½ 2ì‹œ
- **ë‹´ë‹¹ ì„œë¹„ìŠ¤**: ModelOps
- **ì†Œìš” ì‹œê°„**: ì•½ 12-15ì‹œê°„

### ì‘ì—… ë‚´ìš©

451,351ê°œ ê·¸ë¦¬ë“œ í¬ì¸íŠ¸ì— ëŒ€í•´ 9ê°œ ì¬í•´ ìœ í˜•ì˜ ë°œìƒ í™•ë¥ (P(H))ê³¼ AAL(ì—°ê°„ í‰ê·  ì†ì‹¤ë¥ )ì„ ê³„ì‚°í•©ë‹ˆë‹¤.

**ì²˜ë¦¬ ëŒ€ìƒ**:
- **ê·¸ë¦¬ë“œ í¬ì¸íŠ¸**: 451,351ê°œ
- **ì¬í•´ ìœ í˜•**: 9ê°œ (ê·¹í•œ ê³ ì˜¨, ê·¹í•œ í•œíŒŒ, ê°€ë­„, í•˜ì²œí™ìˆ˜, ë„ì‹œí™ìˆ˜, í•´ìˆ˜ë©´ìƒìŠ¹, íƒœí’, ì‚°ë¶ˆ, ìˆ˜ìì› ìŠ¤íŠ¸ë ˆìŠ¤)
- **ì´ ê³„ì‚° ìˆ˜**: 451,351 Ã— 9 = 4,062,159ê°œ

**ë°ì´í„° ì†ŒìŠ¤**:
- Datawarehouse (PostgreSQL 5433 í¬íŠ¸)
- ê¸°í›„ ë°ì´í„° (NetCDF)
- ì‹œë‚˜ë¦¬ì˜¤: SSP126, SSP245, SSP370, SSP585

**ì €ì¥ ìœ„ì¹˜**:
- Application DB (PostgreSQL 5432 í¬íŠ¸)
- `probability_results` í…Œì´ë¸”

### ì„¤ì • ë°©ë²•

`.env` íŒŒì¼:

```bash
PROBABILITY_SCHEDULE_MONTH=1
PROBABILITY_SCHEDULE_DAY=1
PROBABILITY_SCHEDULE_HOUR=2
PROBABILITY_SCHEDULE_MINUTE=0

PARALLEL_WORKERS=4
BATCH_SIZE=1000
```

---

## 2. Hazard Score ê³„ì‚° ë°°ì¹˜

### ê¸°ë³¸ ì •ë³´

- **ë°°ì¹˜ ID**: `hazard_batch`
- **ì‹¤í–‰ ì£¼ê¸°**: ë§¤ì›” 1ì¼ ìƒˆë²½ 4ì‹œ
- **ë‹´ë‹¹ ì„œë¹„ìŠ¤**: ModelOps
- **ì„ í–‰ ì¡°ê±´**: Probability ê³„ì‚° ì™„ë£Œ í›„ ì‹¤í–‰

### ì‘ì—… ë‚´ìš©

Probability ê³„ì‚° ì™„ë£Œ í›„ ìë™ ì‹¤í–‰ë˜ëŠ” ìœ„í—˜ë„ ì ìˆ˜ ê³„ì‚° ë°°ì¹˜ì…ë‹ˆë‹¤.

**ì²˜ë¦¬ ëŒ€ìƒ**:
- Probability ê³„ì‚° ê²°ê³¼ ê¸°ë°˜
- ìœ„í—˜ë„ ë“±ê¸‰ ë¶„ë¥˜ (MINIMAL, LOW, MEDIUM, HIGH, CRITICAL)

**ìœ„í—˜ë„ ë“±ê¸‰**:
- MINIMAL: 0-20
- LOW: 20-40
- MEDIUM: 40-60
- HIGH: 60-80
- CRITICAL: 80-100

**ì €ì¥ ìœ„ì¹˜**:
- Application DB
- `hazard_results` í…Œì´ë¸”

### ì„¤ì • ë°©ë²•

`.env` íŒŒì¼:

```bash
HAZARD_SCHEDULE_MONTH=1
HAZARD_SCHEDULE_DAY=1
HAZARD_SCHEDULE_HOUR=4
HAZARD_SCHEDULE_MINUTE=0
```

---

## 3. ESG Trends Agent ë°°ì¹˜

### ê¸°ë³¸ ì •ë³´

- **ë°°ì¹˜ ID**: `esg_trends_agent`
- **ì‹¤í–‰ ì£¼ê¸°**: ì£¼ 2íšŒ (ì›”ìš”ì¼, ëª©ìš”ì¼)
- **ì‹¤í–‰ ì‹œê°„**: ì˜¤ì „ 9ì‹œ (09:00 KST)
- **ë‹´ë‹¹ ì„œë¹„ìŠ¤**: ModelOps
- **ì‹¤í–‰ ë°©ì‹**: Cron

### ì‘ì—… ë‚´ìš©

ê¸°í›„ ê´€ë ¨ ë‰´ìŠ¤ë¥¼ ìˆ˜ì§‘í•˜ê³  GPT-4o-minië¡œ ë¶„ì„í•˜ì—¬ Slack ì•Œë¦¼ì„ ë°œì†¡í•©ë‹ˆë‹¤.

**ë°ì´í„° ìˆ˜ì§‘**:
- ê¸°ìƒì²­ ë‹¨ê¸°ì˜ˆë³´ API (ë‚ ì”¨ + ë¬¼ë¦¬ì  ë¦¬ìŠ¤í¬)
- esgeconomy.com í¬ë¡¤ë§ (êµ­ë‚´ ESG ë‰´ìŠ¤)
- KOTRA ESG ë™í–¥ë‰´ìŠ¤ API (ê¸€ë¡œë²Œ ESG)
- Fallback: Tavily/DuckDuckGo ê²€ìƒ‰

**LLM ë¶„ì„**:
- ESG í‚¤ì›Œë“œ í•„í„°ë§ (E, S, G ì¹´í…Œê³ ë¦¬)
- GPT-4o-mini ê¸°ë°˜ íŠ¸ë Œë“œ ë¶„ì„
- ê¸‰ë³€ ì´ìŠˆ íƒì§€ ë° ê¶Œê³ ì‚¬í•­ ìƒì„±
- ë°ì´í„° í’ˆì§ˆ ê²€ì¦ (ìµœëŒ€ 2íšŒ ì¬ì‹œë„)

**ë¦¬í¬íŠ¸ ìƒì„±**:
- 8ê°œ ì„¹ì…˜ êµ¬ì¡°í™” ë¦¬í¬íŠ¸
- Slack ìë™ ë°œì†¡ (í˜ì´ì§€ë„¤ì´ì…˜)
- ë§ˆí¬ë‹¤ìš´ í˜•ì‹ ë©”ì‹œì§€

### ì„¤ì • ë°©ë²•

Cron ì„¤ì •:

```bash
# ì›”ìš”ì¼, ëª©ìš”ì¼ ì˜¤ì „ 9ì‹œ ì‹¤í–‰
0 9 * * 1,4 cd /path/to/backend_aiops && ./system_setting/run.sh >> logs/cron.log 2>&1
```

`.env` íŒŒì¼:

```bash
# ESG Trends Agent - APIs
KMA_API_KEY=your_kma_api_key
OPENAI_API_KEY=your_openai_api_key
OPENAI_MODEL=gpt-4o-mini
SLACK_BOT_TOKEN=xoxb-your-slack-bot-token
KOTRA_API_KEY=your_kotra_api_key
TAVILY_API_KEY=your_tavily_api_key

# ESG Trends Agent - Settings
WEATHER_LOCATIONS=ì„œìš¸,ì„±ë‚¨,ëŒ€ì „
SLACK_CHANNEL=auto
ESG_LOG_LEVEL=INFO
```

---

## 4. ì„œë²„ ìƒíƒœ ë³´ê³  ë°°ì¹˜

### ê¸°ë³¸ ì •ë³´

- **ë°°ì¹˜ ID**: `server_status_report`
- **ì‹¤í–‰ ì£¼ê¸°**: ë§¤ì¼
- **ì‹¤í–‰ ì‹œê°„**: ì˜¤ì „ 8ì‹œ (08:00 KST)
- **ë‹´ë‹¹ ì„œë¹„ìŠ¤**: server-monitor

### ì‘ì—… ë‚´ìš©

ì „ì¼ ì„œë²„ ë¦¬ì†ŒìŠ¤ ì‚¬ìš© í˜„í™©ì„ ì´ë©”ì¼ ë¦¬í¬íŠ¸ë¡œ ìƒì„±í•©ë‹ˆë‹¤.

**ëª¨ë‹ˆí„°ë§ í•­ëª©**:
- CPU ì‚¬ìš©ë¥ 
- Memory ì‚¬ìš©ë¥ 
- Disk ì‚¬ìš©ë¥ 
- Network I/O

---

## 5. ì„œë²„ ë¦¬ì†ŒìŠ¤ ëª¨ë‹ˆí„°ë§ ë°°ì¹˜

### ê¸°ë³¸ ì •ë³´

- **ë°°ì¹˜ ID**: `server_resource_monitor`
- **ì‹¤í–‰ ì£¼ê¸°**: 1ë¶„ë§ˆë‹¤
- **ì‹¤í–‰ ì‹œê°„**: ì—°ì† ì‹¤í–‰
- **ë‹´ë‹¹ ì„œë¹„ìŠ¤**: server-monitor

### ì‘ì—… ë‚´ìš©

CPU/Memory/Disk ì‚¬ìš©ë¥ ì´ 80%ë¥¼ ì´ˆê³¼í•˜ë©´ ì´ë©”ì¼ ì•Œë¦¼ì„ ë°œì†¡í•©ë‹ˆë‹¤ (6ì‹œê°„ë§ˆë‹¤ ì¬ì•Œë¦¼).

**ì•Œë¦¼ ì¡°ê±´**:
- CPU ì‚¬ìš©ë¥  > 80%
- Memory ì‚¬ìš©ë¥  > 80%
- Disk ì‚¬ìš©ë¥  > 80%

**ì¬ì•Œë¦¼ ì£¼ê¸°**: 6ì‹œê°„

---

## On-Demand API ë°°ì¹˜

ì‚¬ìš©ì ìš”ì²­ ì‹œ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰ë˜ëŠ” ë°°ì¹˜ ì‘ì—…ì…ë‹ˆë‹¤.

### 1. ì‚¬ì—…ì¥ ë¦¬ìŠ¤í¬ ê³„ì‚° ë°°ì¹˜

#### API ì—”ë“œí¬ì¸íŠ¸

```
POST /api/site-assessment/calculate
```

#### ì‘ì—… ë‚´ìš©

ì—¬ëŸ¬ ì‚¬ì—…ì¥ì— ëŒ€í•œ ì¢…í•© ë¦¬ìŠ¤í¬(E, V, AAL)ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.

**ì²˜ë¦¬ íë¦„**:

```
API ìš”ì²­ (Nê°œ ì‚¬ì—…ì¥)
â†“
ë°±ê·¸ë¼ìš´ë“œ ì‘ì—… ìƒì„± (task_id)
â†“
ë³‘ë ¬ ì²˜ë¦¬ (ThreadPoolExecutor, max_workers=8)
â”œâ”€ ì‚¬ì—…ì¥ 1 â†’ 4ê°œ ì‹œë‚˜ë¦¬ì˜¤ Ã— 80ê°œ ì—°ë„ (2021-2100) = 320ê°œ ê³„ì‚°
â”œâ”€ ì‚¬ì—…ì¥ 2 â†’ 320ê°œ ê³„ì‚°
â””â”€ ì‚¬ì—…ì¥ N â†’ 320ê°œ ê³„ì‚°
â†“
ê° ê³„ì‚°ë§ˆë‹¤ 9ê°œ ë¦¬ìŠ¤í¬ íƒ€ì… í‰ê°€
â”œâ”€ H (Hazard) - DB ì¡°íšŒ
â”œâ”€ E (Exposure) - ê±´ë¬¼ ì •ë³´ ê¸°ë°˜
â”œâ”€ V (Vulnerability) - ê±´ë¬¼ êµ¬ì¡° ê¸°ë°˜
â””â”€ AAL (Annual Average Loss) - P Ã— DR ê³„ì‚°
â†“
Application DB ì €ì¥ (evaal_results í…Œì´ë¸”)
â†“
ì§„í–‰ë¥  ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
```

**ë³‘ë ¬ ì²˜ë¦¬ ì „ëµ**:
- **ìµœëŒ€ ì›Œì»¤ ìˆ˜**: 8ê°œ
- **ì‹œë‚˜ë¦¬ì˜¤**: SSP126, SSP245, SSP370, SSP585 (4ê°œ)
- **ì—°ë„ ë²”ìœ„**: 2021-2100 (80ë…„)
- **ë¦¬ìŠ¤í¬ íƒ€ì…**: 9ê°œ
- **ì´ ê³„ì‚° ìˆ˜**: `ì‚¬ì—…ì¥ ìˆ˜ Ã— 4 Ã— 80 Ã— 9`

**ì‹¤ì‹œê°„ ë¡œê¹…**:

```
logs/task_[task_id]/
â”œâ”€â”€ [site_id]_start.log          # ì‹œì‘ ë¡œê·¸
â”œâ”€â”€ [site_id]_[year]_[scenario].log  # ì—°ë„ë³„ ì™„ë£Œ ë¡œê·¸
â””â”€â”€ [site_id]_summary.log        # ìš”ì•½ ë¡œê·¸
```

**ì§„í–‰ë¥  ì¡°íšŒ**:

```
GET /api/site-assessment/task-status/{task_id}
```

**ì‘ë‹µ ì˜ˆì‹œ**:

```json
{
  "task_id": "abc-123-def-456",
  "task_type": "calculate",
  "status": "running",
  "total_sites": 5,
  "completed_sites": 2,
  "failed_sites": 0,
  "total_years": 320,
  "progress_percentage": 40.0,
  "current_progress": {
    "site_1": {
      "completed_years": 320,
      "failed_years": 0
    },
    "site_2": {
      "completed_years": 320,
      "failed_years": 0
    },
    "site_3": {
      "completed_years": 128,
      "failed_years": 0
    }
  }
}
```

---

### 2. ì‚¬ì—…ì¥ ì´ì „ í›„ë³´ì§€ ì¶”ì²œ ë°°ì¹˜

#### API ì—”ë“œí¬ì¸íŠ¸

```
POST /api/site-assessment/recommend-locations
```

#### ì‘ì—… ë‚´ìš©

ì‚¬ì—…ì¥ ì´ì „ì„ ìœ„í•œ ìµœì  í›„ë³´ì§€ë¥¼ í‰ê°€í•˜ê³  ì¶”ì²œí•©ë‹ˆë‹¤.

**ì²˜ë¦¬ íë¦„**:

```
API ìš”ì²­
â”œâ”€ Nê°œ ì‚¬ì—…ì¥ ì •ë³´
â”œâ”€ Mê°œ í›„ë³´ì§€ ì¢Œí‘œ (ë˜ëŠ” ê³ ì • 10ê°œ ìœ„ì¹˜ ì‚¬ìš©)
â”œâ”€ ê²€ìƒ‰ ê¸°ì¤€ (ì‹œë‚˜ë¦¬ì˜¤, ëª©í‘œì—°ë„)
â””â”€ ê±´ë¬¼/ìì‚° ì •ë³´
â†“
Early Callback ì²´í¬
â”œâ”€ DBì— í›„ë³´ì§€ ë°ì´í„° 90% ì´ìƒ ì¡´ì¬?
â”‚   â”œâ”€ YES â†’ ì¦‰ì‹œ FastAPI ì„œë²„ì— ì½œë°± í˜¸ì¶œ
â”‚   â””â”€ NO â†’ ê³„ì‚° ì§„í–‰
â†“
ë³‘ë ¬ ì²˜ë¦¬ (ThreadPoolExecutor, max_workers=8)
â”œâ”€ ì‚¬ì—…ì¥ 1 â†’ Mê°œ í›„ë³´ì§€ í‰ê°€
â”œâ”€ ì‚¬ì—…ì¥ 2 â†’ Mê°œ í›„ë³´ì§€ í‰ê°€
â””â”€ ì‚¬ì—…ì¥ N â†’ Mê°œ í›„ë³´ì§€ í‰ê°€
â†“
ê° í›„ë³´ì§€ë§ˆë‹¤
â”œâ”€ ì´ë¯¸ DBì— ì¡´ì¬? â†’ ê±´ë„ˆë›°ê¸°
â”œâ”€ E, V, AAL ì˜¨ë””ë§¨ë“œ ê³„ì‚°
â”œâ”€ í†µí•© ë¦¬ìŠ¤í¬ ì ìˆ˜ ê³„ì‚° (H Ã— E Ã— V / 10000)
â””â”€ candidate_sites í…Œì´ë¸”ì— ì €ì¥
    â”œâ”€ latitude, longitude
    â”œâ”€ risk_score (0-100)
    â”œâ”€ total_aal
    â”œâ”€ aal_by_risk (9ê°œ ë¦¬ìŠ¤í¬ë³„)
    â””â”€ risks (9ê°œ ë¦¬ìŠ¤í¬ë³„ ì ìˆ˜)
â†“
ê³„ì‚° ì™„ë£Œ í›„ ì½œë°± í˜¸ì¶œ (Early Callback ë¯¸í˜¸ì¶œ ì‹œ)
â†“
FastAPI ì„œë²„ì— ì™„ë£Œ ì•Œë¦¼
```

**ë³‘ë ¬ ì²˜ë¦¬ ì „ëµ**:
- **ìµœëŒ€ ì›Œì»¤ ìˆ˜**: 8ê°œ
- **í›„ë³´ì§€ ìˆ˜**: ì‚¬ìš©ì ì œê³µ ë˜ëŠ” ê³ ì • 10ê°œ ìœ„ì¹˜
- **ì‹œë‚˜ë¦¬ì˜¤**: ë‹¨ì¼ (ê¸°ë³¸ SSP245)
- **ëª©í‘œì—°ë„**: ë‹¨ì¼ (ê¸°ë³¸ 2040)
- **ë¦¬ìŠ¤í¬ íƒ€ì…**: 9ê°œ
- **ì´ ê³„ì‚° ìˆ˜**: `ì‚¬ì—…ì¥ ìˆ˜ Ã— í›„ë³´ì§€ ìˆ˜ Ã— 9`

**Early Callback ìµœì í™”**:
- DBì— í›„ë³´ì§€ ë°ì´í„°ê°€ 90% ì´ìƒ ì¡´ì¬í•˜ë©´ ì¦‰ì‹œ ì½œë°± í˜¸ì¶œ
- ë¶ˆí•„ìš”í•œ ì¬ê³„ì‚° ë°©ì§€
- í”„ë¡ íŠ¸ì—”ë“œ ì‘ë‹µ ì‹œê°„ ë‹¨ì¶•

**ê³ ì • í›„ë³´ì§€ ìœ„ì¹˜** (LOCATION_MAP):

```python
# 10ê°œ ê³ ì • í›„ë³´ì§€ ì¢Œí‘œ
[
  {"lat": 37.5665, "lng": 126.9780},  # ì„œìš¸
  {"lat": 35.1796, "lng": 129.0756},  # ë¶€ì‚°
  {"lat": 37.4563, "lng": 126.7052},  # ì¸ì²œ
  {"lat": 35.8714, "lng": 128.6014},  # ëŒ€êµ¬
  {"lat": 36.3504, "lng": 127.3845},  # ëŒ€ì „
  {"lat": 35.5384, "lng": 129.3114},  # ìš¸ì‚°
  {"lat": 35.1595, "lng": 126.8526},  # ê´‘ì£¼
  {"lat": 36.6424, "lng": 127.4890},  # ì„¸ì¢…
  {"lat": 37.2636, "lng": 127.0286},  # ìˆ˜ì›
  {"lat": 33.4996, "lng": 126.5312}   # ì œì£¼
]
```

**ì½œë°± URL**:

```
POST {FASTAPI_URL}/api/analysis/modelops/recommendation-completed?batchId={batch_id}
```

---

## ë°°ì¹˜ ì‘ì—… ëª¨ë‹ˆí„°ë§

### ì‘ì—… ìƒíƒœ ì¡°íšŒ

**ëª¨ë“  ì‘ì—… ì¡°íšŒ**:

```bash
GET /api/site-assessment/tasks
```

**íŠ¹ì • ì‘ì—… ì¡°íšŒ**:

```bash
GET /api/site-assessment/task-status/{task_id}
```

**ìŠ¤ì¼€ì¤„ëœ ì‘ì—… ì¡°íšŒ**:

```bash
GET /api/batch-trigger/scheduled-jobs
```

### ë¡œê·¸ í™•ì¸

**ESG Trends Agent ë¡œê·¸**:

```bash
tail -f logs/cron.log
tail -f logs/esg_agent.log
```

**ModelOps ë°°ì¹˜ ë¡œê·¸**:

```bash
tail -f logs/task_[task_id]/[site_id]_start.log
tail -f logs/task_[task_id]/[site_id]_summary.log
```

**FastAPI ì„œë²„ ë¡œê·¸**:

```bash
tail -f logs/modelops_server.log
```

### ì‘ì—… ì‚­ì œ

```bash
DELETE /api/site-assessment/task/{task_id}
```

---

## ë°°ì¹˜ ì‘ì—… ì„±ëŠ¥ ìµœì í™”

### ë³‘ë ¬ ì²˜ë¦¬ ì›Œì»¤ ìˆ˜ ì¡°ì •

`.env` íŒŒì¼:

```bash
# ModelOps ë°°ì¹˜
PARALLEL_WORKERS=4
BATCH_SIZE=1000

# On-Demand API (ì½”ë“œ ë‚´ MAX_WORKERS)
# site_assessment.py: MAX_WORKERS = 8
```

### DB ì—°ê²° í’€ ì„¤ì •

```bash
# Datawarehouse
DW_POOL_SIZE=10
DW_MAX_OVERFLOW=20

# Application DB
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
```

---

## ë¬¸ì œ í•´ê²°

### ë°°ì¹˜ ì‘ì—…ì´ ì‹¤í–‰ë˜ì§€ ì•Šì„ ë•Œ

1. **APScheduler ìƒíƒœ í™•ì¸**:

```bash
GET /api/batch-trigger/scheduled-jobs
```

2. **Cron ì‘ì—… í™•ì¸**:

```bash
crontab -l
tail -f logs/cron.log
```

3. **ì„œë²„ ë¡œê·¸ í™•ì¸**:

```bash
tail -f logs/modelops_server.log
```

### ë°°ì¹˜ ì‘ì—…ì´ ì‹¤íŒ¨í•  ë•Œ

1. **ì‘ì—… ìƒíƒœ í™•ì¸**:

```bash
GET /api/site-assessment/task-status/{task_id}
```

2. **ë¡œê·¸ íŒŒì¼ í™•ì¸**:

```bash
cat logs/task_[task_id]/[site_id]_summary.log
```

3. **DB ì—°ê²° í™•ì¸**:

```bash
psql -h localhost -p 5432 -U skala_app_user -d skala_application
psql -h localhost -p 5433 -U skala_dw_user -d skala_datawarehouse
```

---

## ê´€ë ¨ ë¬¸ì„œ

- [README.md](README.md) - í”„ë¡œì íŠ¸ ì „ì²´ ê°œìš”
- [BATCH_SCHEDULE_GUIDE.md](BATCH_SCHEDULE_GUIDE.md) - ë°°ì¹˜ ìŠ¤ì¼€ì¤„ ìƒì„¸ ê°€ì´ë“œ
- [docs/API_TEST_GUIDE.md](docs/API_TEST_GUIDE.md) - API í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ

---

**ìµœì¢… ìˆ˜ì •**: 2025-12-19
**ë‹´ë‹¹**: SKALA Physical Risk AI Team
