<img src="https://r2cdn.perplexity.ai/pplx-full-logo-primary-dark%402x.png" style="height:64px;margin-right:32px"/>

# ê·¸ëŸ¼ ì´ì œ ê° ë°ì´í„° ì–´ë–»ê²Œ ì €ì¥í•˜ëŠ”ì§€ ì´ ì •ë¦¬í•´ì¤˜

ì™„ë²½í•©ë‹ˆë‹¤! SK AX ê¸°í›„ ë¦¬ìŠ¤í¬ í”„ë¡œì íŠ¸ë¥¼ ìœ„í•œ **ëª¨ë“  ë°ì´í„° íƒ€ì…ë³„ ì €ì¥ ë°©ë²•**ì„ ì¢…í•©ì ìœ¼ë¡œ ì •ë¦¬í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

## ğŸ“Š ë°ì´í„° íƒ€ì…ë³„ PostgreSQL ì €ì¥ ì „ëµ ì´ì •ë¦¬

### 1ï¸âƒ£ DEM (Digital Elevation Model) - TIF í˜•ì‹

**ë°ì´í„° íŠ¹ì„±**: ì§€í˜• ê³ ë„ ì •ë³´, í”½ì…€ ê²©ì ë°ì´í„°

**ì €ì¥ ë°©ì‹**: PostGIS Raster íƒ€ì…

**ì²˜ë¦¬ í”„ë¡œì„¸ìŠ¤**:

```bash
# 1. TIF íŒŒì¼ì„ 128x128 íƒ€ì¼ë¡œ ë¶„í• í•˜ì—¬ ë¡œë“œ
raster2pgsql -C -I -M -F -t 128x128 -s 4326 \
  dem_korea.tif public.dem_tiles | psql -d climate_risk

# ì˜µì…˜ ì„¤ëª…:
# -C: ì œì•½ì¡°ê±´ ìƒì„±
# -I: ê³µê°„ ì¸ë±ìŠ¤ ìƒì„±
# -M: VACUUM ANALYZE ì‹¤í–‰
# -F: íŒŒì¼ëª…ì„ ì»¬ëŸ¼ì— ì¶”ê°€
# -t: íƒ€ì¼ í¬ê¸° ì§€ì •
# -s: SRID(ì¢Œí‘œê³„) ì§€ì •
```

**í…Œì´ë¸” êµ¬ì¡°**:

```sql
CREATE TABLE dem_tiles (
    rid SERIAL PRIMARY KEY,
    rast RASTER,                    -- íƒ€ì¼ë³„ í”½ì…€ ë°ì´í„°
    filename TEXT,
    tile_x INTEGER,
    tile_y INTEGER,
    created_at TIMESTAMP DEFAULT NOW()
);

-- ê³µê°„ ì¸ë±ìŠ¤ (ìë™ ìƒì„±ë¨)
CREATE INDEX dem_tiles_rast_gist_idx 
ON dem_tiles USING GIST (ST_ConvexHull(rast));
```

**ì €ì¥ êµ¬ì¡°**:

- í•˜ë‚˜ì˜ ëŒ€í˜• TIF â†’ ìˆ˜ë°±~ìˆ˜ì²œ ê°œì˜ íƒ€ì¼ í–‰
- ê° í–‰ = 128x128 í”½ì…€ ë°ì´í„°

***

### 2ï¸âƒ£ í† ì§€í”¼ë³µë„ (Land Cover) - TIF í˜•ì‹

**ë°ì´í„° íŠ¹ì„±**: í† ì§€ ìœ í˜• ë¶„ë¥˜ ë°ì´í„° (ìˆ², ë†ì§€, ë„ì‹œ ë“±)

**ì €ì¥ ë°©ì‹**: PostGIS Raster íƒ€ì… (DEMê³¼ ë™ì¼)

**ì²˜ë¦¬ í”„ë¡œì„¸ìŠ¤**:

```bash
raster2pgsql -C -I -M -F -t 100x100 -s 5179 \
  landcover_2024.tif public.landcover_tiles | psql -d climate_risk
```

**í…Œì´ë¸” êµ¬ì¡°**:

```sql
CREATE TABLE landcover_tiles (
    rid SERIAL PRIMARY KEY,
    rast RASTER,
    land_type_code INTEGER,         -- í† ì§€ ìœ í˜• ì½”ë“œ
    acquisition_date DATE,
    tile_x INTEGER,
    tile_y INTEGER,
    created_at TIMESTAMP DEFAULT NOW()
);
```

**í™œìš© ì¿¼ë¦¬**:

```sql
-- íŠ¹ì • ì‚¬ì—…ì¥ ìœ„ì¹˜ì˜ í† ì§€í”¼ë³µ ìœ í˜• ì¶”ì¶œ
SELECT ST_Value(rast, ST_Transform(
    ST_SetSRID(ST_Point(127.0, 37.5), 4326), 5179
)) AS land_type
FROM landcover_tiles
WHERE ST_Intersects(rast, 
    ST_Transform(ST_SetSRID(ST_Point(127.0, 37.5), 4326), 5179)
);
```


***

### 3ï¸âƒ£ í•´ì•ˆì„  (Coastline) - SHP í˜•ì‹

**ë°ì´í„° íŠ¹ì„±**: ë²¡í„° ì„  ë°ì´í„°, í•´ì•ˆ ê²½ê³„ì„ 

**ì €ì¥ ë°©ì‹**: PostGIS Geometry (LINESTRING/MULTILINESTRING)

**ì²˜ë¦¬ í”„ë¡œì„¸ìŠ¤**:

```bash
# Shapefileì„ PostgreSQLë¡œ ë¡œë“œ
shp2pgsql -I -s 4326 -W UTF-8 \
  coastline_korea.shp public.coastline_data | psql -d climate_risk

# ì˜µì…˜ ì„¤ëª…:
# -I: ê³µê°„ ì¸ë±ìŠ¤ ìƒì„±
# -s: SRID ì§€ì •
# -W: ì¸ì½”ë”© ì§€ì •
```

**í…Œì´ë¸” êµ¬ì¡°**:

```sql
CREATE TABLE coastline_data (
    gid SERIAL PRIMARY KEY,
    geom GEOMETRY(MULTILINESTRING, 4326),  -- í•´ì•ˆì„  ì¢Œí‘œ
    region_name VARCHAR(100),
    coast_length_km NUMERIC(10,2),
    erosion_risk_level VARCHAR(20),        -- ì¹¨ì‹ ìœ„í—˜ë„
    sea_level_rise_vulnerable BOOLEAN,     -- í•´ìˆ˜ë©´ ìƒìŠ¹ ì·¨ì•½ì„±
    data_source VARCHAR(100),
    acquisition_date DATE,
    created_at TIMESTAMP DEFAULT NOW()
);

-- ê³µê°„ ì¸ë±ìŠ¤
CREATE INDEX coastline_geom_gist_idx 
ON coastline_data USING GIST(geom);
```

**ì €ì¥ êµ¬ì¡°**:

- ê° í•´ì•ˆì„  ê°ì²´ = 1ê°œ í–‰
- í•œêµ­ í•´ì•ˆì„  100ê°œ Feature â†’ 100ê°œ í–‰

**í™œìš© ì¿¼ë¦¬**:

```sql
-- ì‚¬ì—…ì¥ì—ì„œ 5km ì´ë‚´ í•´ì•ˆì„  ì°¾ê¸°
SELECT gid, region_name, 
       ST_Distance(geom::geography, 
           ST_SetSRID(ST_Point(129.1, 35.1), 4326)::geography
       ) / 1000 AS distance_km
FROM coastline_data
WHERE ST_DWithin(
    geom::geography,
    ST_SetSRID(ST_Point(129.1, 35.1), 4326)::geography,
    5000
)
ORDER BY distance_km;
```


***

### 4ï¸âƒ£ í† ì–‘ìˆ˜ë¶„ (Soil Moisture) - H5 í˜•ì‹

**ë°ì´í„° íŠ¹ì„±**: HDF5 í¬ë§·, ë‹¤ì°¨ì› ë°°ì—´ ë°ì´í„°

**ì €ì¥ ë°©ì‹**:

- **ì˜µì…˜ 1 (ê¶Œì¥)**: GDALë¡œ GeoTIFF ë³€í™˜ í›„ Raster ì €ì¥[^1][^2]
- **ì˜µì…˜ 2**: ë©”íƒ€ë°ì´í„°ë§Œ DB, ì›ë³¸ì€ íŒŒì¼ì‹œìŠ¤í…œ (Out-DB)

**ì²˜ë¦¬ í”„ë¡œì„¸ìŠ¤ (ì˜µì…˜ 1)**:

```bash
# 1. H5ì—ì„œ ì„œë¸Œë°ì´í„°ì…‹ í™•ì¸
gdalinfo soil_moisture_20241119.h5

# 2. íŠ¹ì • ë ˆì´ì–´ë¥¼ GeoTIFFë¡œ ë³€í™˜
gdal_translate -of GTiff \
  HDF5:"soil_moisture_20241119.h5"://SoilMoisture \
  soil_moisture_20241119.tif

# 3. PostgreSQLë¡œ ë¡œë“œ
raster2pgsql -C -I -M -t 128x128 -s 4326 \
  soil_moisture_20241119.tif public.soil_moisture_tiles | psql -d climate_risk
```

**í…Œì´ë¸” êµ¬ì¡° (ì˜µì…˜ 1 - In-DB)**:

```sql
CREATE TABLE soil_moisture_tiles (
    rid SERIAL PRIMARY KEY,
    rast RASTER,
    measurement_date DATE,
    soil_depth_cm INTEGER,          -- ì¸¡ì • ê¹Šì´ (0-10cm, 10-40cm ë“±)
    satellite_source VARCHAR(50),   -- ìœ„ì„± ì¶œì²˜ (SMAP, SMOS ë“±)
    tile_x INTEGER,
    tile_y INTEGER,
    created_at TIMESTAMP DEFAULT NOW()
);
```

**í…Œì´ë¸” êµ¬ì¡° (ì˜µì…˜ 2 - Out-DB)**:

```sql
CREATE TABLE soil_moisture_metadata (
    moisture_id SERIAL PRIMARY KEY,
    file_path TEXT,                 -- /data/soil_moisture/20241119.h5
    file_format VARCHAR(10),        -- 'H5'
    measurement_date DATE,
    soil_depth_cm INTEGER,
    bbox GEOMETRY(POLYGON, 4326),   -- ê³µê°„ ë²”ìœ„
    file_size_mb NUMERIC(10,2),
    checksum VARCHAR(64),           -- íŒŒì¼ ë¬´ê²°ì„± ê²€ì¦
    created_at TIMESTAMP DEFAULT NOW()
);
```

**ê¶Œì¥**: ë¶„ì„ ë¹ˆë„ê°€ ë†’ìœ¼ë©´ ì˜µì…˜ 1, íŒŒì¼ì´ ë§¤ìš° í¬ë©´ ì˜µì…˜ 2[^3][^4]

***

### 5ï¸âƒ£ NDVI (ì‹ìƒì§€ìˆ˜) - HDF í˜•ì‹

**ë°ì´í„° íŠ¹ì„±**: MODIS HDF4 í¬ë§·, ì‹ìƒ ê±´ê°•ë„ ì§€í‘œ

**ì €ì¥ ë°©ì‹**: H5ì™€ ë™ì¼ ì „ëµ (GeoTIFF ë³€í™˜ í›„ Raster ì €ì¥)[^5][^1]

**ì²˜ë¦¬ í”„ë¡œì„¸ìŠ¤**:

```bash
# 1. HDF4 ì„œë¸Œë°ì´í„°ì…‹ í™•ì¸
gdalinfo MOD13A2.A2024323.h09v05.061.h5

# 2. NDVI ë ˆì´ì–´ ì¶”ì¶œ ë° ë³€í™˜
gdal_translate -of GTiff \
  HDF4_EOS:EOS_GRID:"MOD13A2.A2024323.h09v05.061.h5":MODIS_Grid_16DAY_1KM_VI:1_km_16_days_NDVI \
  ndvi_20241119.tif

# 3. PostgreSQLë¡œ ë¡œë“œ
raster2pgsql -C -I -M -t 128x128 -s 4326 \
  ndvi_20241119.tif public.ndvi_tiles | psql -d climate_risk
```

**í…Œì´ë¸” êµ¬ì¡°**:

```sql
CREATE TABLE ndvi_tiles (
    rid SERIAL PRIMARY KEY,
    rast RASTER,
    acquisition_date DATE,
    satellite_product VARCHAR(50),  -- MOD13A2, MYD13A2 ë“±
    quality_flag INTEGER,           -- í”½ì…€ í’ˆì§ˆ í”Œë˜ê·¸
    tile_x INTEGER,
    tile_y INTEGER,
    created_at TIMESTAMP DEFAULT NOW()
);

-- ê³µê°„ ì¸ë±ìŠ¤
CREATE INDEX ndvi_tiles_rast_gist_idx 
ON ndvi_tiles USING GIST (ST_ConvexHull(rast));
```

**í™œìš© ì¿¼ë¦¬**:

```sql
-- ì‹œê³„ì—´ NDVI ë³€í™” ë¶„ì„
SELECT 
    acquisition_date,
    AVG((ST_SummaryStats(rast)).mean) AS avg_ndvi,
    COUNT(*) AS tile_count
FROM ndvi_tiles
WHERE acquisition_date BETWEEN '2024-01-01' AND '2024-12-31'
GROUP BY acquisition_date
ORDER BY acquisition_date;
```


***

## ğŸ—‚ï¸ í†µí•© ERD ì„¤ê³„

```sql
-- 1. ì‚¬ì—…ì¥ ì •ë³´
CREATE TABLE site_locations (
    site_id SERIAL PRIMARY KEY,
    site_name VARCHAR(200),
    site_code VARCHAR(50) UNIQUE,
    geom GEOMETRY(POINT, 4326),
    address TEXT,
    business_type VARCHAR(100),
    created_at TIMESTAMP DEFAULT NOW()
);

-- 2. ë˜ìŠ¤í„° ë©”íƒ€ë°ì´í„° (ê³µí†µ)
CREATE TABLE raster_metadata (
    raster_id SERIAL PRIMARY KEY,
    data_type VARCHAR(50),          -- 'DEM', 'LANDCOVER', 'SOIL_MOISTURE', 'NDVI'
    original_filename TEXT,
    acquisition_date DATE,
    resolution_m NUMERIC(10,2),
    crs_srid INTEGER,
    total_tiles INTEGER,
    storage_type VARCHAR(20),       -- 'IN_DB', 'OUT_DB'
    file_path TEXT,                 -- OUT_DBì¸ ê²½ìš°
    created_at TIMESTAMP DEFAULT NOW()
);

-- 3. DEM íƒ€ì¼
CREATE TABLE dem_tiles (
    rid SERIAL PRIMARY KEY,
    raster_id INTEGER REFERENCES raster_metadata(raster_id),
    rast RASTER,
    tile_x INTEGER,
    tile_y INTEGER,
    created_at TIMESTAMP DEFAULT NOW()
);

-- 4. í† ì§€í”¼ë³µë„ íƒ€ì¼
CREATE TABLE landcover_tiles (
    rid SERIAL PRIMARY KEY,
    raster_id INTEGER REFERENCES raster_metadata(raster_id),
    rast RASTER,
    tile_x INTEGER,
    tile_y INTEGER,
    created_at TIMESTAMP DEFAULT NOW()
);

-- 5. í•´ì•ˆì„  ë°ì´í„°
CREATE TABLE coastline_data (
    gid SERIAL PRIMARY KEY,
    geom GEOMETRY(MULTILINESTRING, 4326),
    region_name VARCHAR(100),
    coast_length_km NUMERIC(10,2),
    erosion_risk_level VARCHAR(20),
    acquisition_date DATE,
    created_at TIMESTAMP DEFAULT NOW()
);

-- 6. í† ì–‘ìˆ˜ë¶„ íƒ€ì¼
CREATE TABLE soil_moisture_tiles (
    rid SERIAL PRIMARY KEY,
    raster_id INTEGER REFERENCES raster_metadata(raster_id),
    rast RASTER,
    measurement_date DATE,
    soil_depth_cm INTEGER,
    tile_x INTEGER,
    tile_y INTEGER,
    created_at TIMESTAMP DEFAULT NOW()
);

-- 7. NDVI íƒ€ì¼
CREATE TABLE ndvi_tiles (
    rid SERIAL PRIMARY KEY,
    raster_id INTEGER REFERENCES raster_metadata(raster_id),
    rast RASTER,
    acquisition_date DATE,
    tile_x INTEGER,
    tile_y INTEGER,
    created_at TIMESTAMP DEFAULT NOW()
);

-- 8. ê¸°í›„ ë¦¬ìŠ¤í¬ ë¶„ì„ ê²°ê³¼
CREATE TABLE climate_risk_analysis (
    analysis_id SERIAL PRIMARY KEY,
    site_id INTEGER REFERENCES site_locations(site_id),
    risk_type VARCHAR(50),          -- 'í•´ìˆ˜ë©´ìƒìŠ¹', 'ì‚°ë¶ˆ', 'ê°€ë­„', 'íƒœí’' ë“±
    risk_score NUMERIC(5,2),        -- 0-100 ì ìˆ˜
    scenario VARCHAR(20),           -- 'SSP1-2.6', 'SSP5-8.5' ë“±
    analysis_result JSONB,          -- ìƒì„¸ ë¶„ì„ ê²°ê³¼
    analysis_date DATE,
    created_at TIMESTAMP DEFAULT NOW()
);

-- í•„ìˆ˜ ì¸ë±ìŠ¤ ìƒì„±
CREATE INDEX site_locations_geom_gist_idx ON site_locations USING GIST(geom);
CREATE INDEX coastline_geom_gist_idx ON coastline_data USING GIST(geom);
CREATE INDEX dem_tiles_rast_gist_idx ON dem_tiles USING GIST(ST_ConvexHull(rast));
CREATE INDEX landcover_tiles_rast_gist_idx ON landcover_tiles USING GIST(ST_ConvexHull(rast));
CREATE INDEX soil_moisture_tiles_rast_gist_idx ON soil_moisture_tiles USING GIST(ST_ConvexHull(rast));
CREATE INDEX ndvi_tiles_rast_gist_idx ON ndvi_tiles USING GIST(ST_ConvexHull(rast));
```


***

## ğŸ“‹ ì €ì¥ ë°©ì‹ ë¹„êµí‘œ

| ë°ì´í„° | ì›ë³¸ í˜•ì‹ | PostgreSQL íƒ€ì… | ì €ì¥ ë‹¨ìœ„ | ì²˜ë¦¬ ë„êµ¬ | íƒ€ì¼ë§ í•„ìš” |
| :-- | :-- | :-- | :-- | :-- | :-- |
| **DEM** | TIF | RASTER | íƒ€ì¼ë³„ í–‰ | raster2pgsql | âœ… í•„ìˆ˜ |
| **í† ì§€í”¼ë³µë„** | TIF | RASTER | íƒ€ì¼ë³„ í–‰ | raster2pgsql | âœ… í•„ìˆ˜ |
| **í•´ì•ˆì„ ** | SHP | GEOMETRY | ê°ì²´ë³„ í–‰ | shp2pgsql | âŒ ë¶ˆí•„ìš” |
| **í† ì–‘ìˆ˜ë¶„** | H5 | RASTER | íƒ€ì¼ë³„ í–‰ | gdal_translate â†’ raster2pgsql | âœ… í•„ìˆ˜ |
| **NDVI** | HDF | RASTER | íƒ€ì¼ë³„ í–‰ | gdal_translate â†’ raster2pgsql | âœ… í•„ìˆ˜ |


***

## ğŸ”§ ì„±ëŠ¥ ìµœì í™” íŒ

**íƒ€ì¼ í¬ê¸° ì„ íƒ**: 100x100 ~ 128x128 í”½ì…€ ê¶Œì¥[^3]

**ê³µê°„ ì¸ë±ìŠ¤ í•„ìˆ˜**: GIST ì¸ë±ìŠ¤ë¡œ ì¿¼ë¦¬ ì†ë„ 10ë°° ì´ìƒ í–¥ìƒ[^6][^3]

**í†µê³„ ì—…ë°ì´íŠ¸**: ì£¼ê¸°ì ìœ¼ë¡œ `ANALYZE` ì‹¤í–‰[^6]

```sql
ANALYZE dem_tiles;
ANALYZE ndvi_tiles;
```

**Out-DB ê³ ë ¤**: 100GB ì´ìƒ íŒŒì¼ì€ ì™¸ë¶€ ì €ì¥ í›„ ë©”íƒ€ë°ì´í„°ë§Œ ê´€ë¦¬[^4]

**ë³‘ë ¬ ì²˜ë¦¬**: ëŒ€ìš©ëŸ‰ ë°ì´í„°ëŠ” ì§€ì—­ë³„ë¡œ ë¶„í•  ë¡œë“œ[^3]

ì´ ì„¤ê³„ë¡œ SK AXì˜ 7ëŒ€ ê¸°í›„ë¦¬ìŠ¤í¬ ìš”ì¸ì„ íš¨ìœ¨ì ìœ¼ë¡œ ì €ì¥í•˜ê³  SSP ì‹œë‚˜ë¦¬ì˜¤ë³„ ë¦¬ìŠ¤í¬ ë¶„ì„ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ ![^7][^4]
<span style="display:none">[^10][^11][^12][^13][^14][^15][^16][^17][^18][^8][^9]</span>

<div align="center">â‚</div>

[^1]: https://www.mdpi.com/1424-8220/20/4/984

[^2]: https://stackoverflow.com/questions/22933598/how-to-transform-hdf5-to-geotiff-using-gdal-translate-or-gdalwarp

[^3]: https://www.maplibrary.org/11342/7-methods-for-optimizing-geospatial-data-for-performance/

[^4]: https://nhess.copernicus.org/articles/16/85/2016/nhess-16-85-2016.pdf

[^5]: https://community.appliedepi.org/t/gdal-and-hdf4-files-for-conversion-to-tif-in-r-or-elsewhere/1505

[^6]: https://www.tigerdata.com/learn/postgres-performance-best-practices

[^7]: https://journals.vilniustech.lt/index.php/GAC/article/download/14791/11248

[^8]: https://pmc.ncbi.nlm.nih.gov/articles/PMC10562832/

[^9]: https://linkinghub.elsevier.com/retrieve/pii/S0924271617300898

[^10]: http://openresearchsoftware.metajnl.com/articles/10.5334/jors.267/galley/378/download/

[^11]: https://joss.theoj.org/papers/10.21105/joss.03541.pdf

[^12]: https://www.mdpi.com/1424-8220/24/19/6267

[^13]: https://www.mdpi.com/1999-5903/4/4/1069/pdf?version=1355491918

[^14]: https://www.mdpi.com/2072-4292/8/5/382/pdf?version=1462363089

[^15]: https://lists.osgeo.org/pipermail/gdal-dev/2016-December/045709.html

[^16]: https://www.reddit.com/r/remotesensing/comments/nzyr3w/conversion_question_hdf5_to_geotiff/

[^17]: https://gdal.org/en/stable/programs/gdal_translate.html

[^18]: https://github.com/osgeo/gdal/issues/12774

