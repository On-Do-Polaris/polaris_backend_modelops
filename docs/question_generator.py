# question_generator.py

import random

# --- 전문가 상담 연계를 위한 구조화된 질문 은행 (카테고리별 30개) ---
# level 1: 관계 형성, level 2: 탐색, level 3: 심층
# 분량상 일부 카테고리(PEER, SCH)만 30개 예시를 채웠습니다. 
# 다른 카테고리도 동일한 방식으로 확장하시면 됩니다.
QUESTION_BANK = {
    "BAS": [
    # Level 1
        {"id": "B01", "level": 1, "text": "만나서 반가워. 오늘 하루는 어땠어?", "insight": "대화 시작 및 초기 라포 형성, 전반적인 하루의 기분 상태 파악"},
        {"id": "B02", "level": 1, "text": "요즘 너를 가장 즐겁게 해주는 게 있다면 뭐야?", "insight": "긍정적 자원 및 현재의 주요 관심사 탐색"},
        {"id": "B03", "level": 1, "text": "네가 가장 좋아하는 과목이나 취미에 대해 알려줄래?", "insight": "흥미 및 강점 분야를 파악하여 긍정적 대화 주제로 활용"},
        {"id": "B04", "level": 1, "text": "학교 끝나고 나면 보통 뭐하면서 시간을 보내?", "insight": "일상적인 생활 패턴 및 방과 후 활동 파악"},
        {"id": "B05", "level": 1, "text": "너에 대해 한 가지만 소개해 줄 수 있을까? 어떤 것이든 좋아.", "insight": "자기 표현 방식 및 자신을 어떻게 소개하고 싶은지 파악"},
        
    # Level 2
        {"id": "B06", "level": 2, "text": "지금 누구랑 같이 살고 있어?", "insight": "가족 구성 및 주거 환경에 대한 기본적인 정보 파악"},
        {"id": "B07", "level": 2, "text": "요즘 너의 가장 큰 고민거리는 뭐야?", "insight": "주요 호소 문제를 직접적으로 탐색"},
        {"id": "B08", "level": 2, "text": "네가 생각하는 너의 가장 큰 장점은 뭐야?", "insight": "자기 인식 및 자존감의 긍정적 측면 평가"},
        {"id": "B09", "level": 2, "text": "주말에는 보통 누구랑 시간을 보내는 편이야?", "insight": "주요 사회적 관계망(가족/친구) 파악"},
        {"id": "B10", "level": 2, "text": "요즘 건강은 어때? 특별히 아프거나 힘든 곳은 없어?", "insight": "기본적인 신체 건강 상태(Health Condition) 스크리닝"},
        {"id": "B11", "level": 2, "text": "이 상담을 통해 무엇을 얻고 싶거나 해결하고 싶어?", "insight": "상담에 대한 기대 및 동기 수준 파악"},
        {"id": "B12", "level": 2, "text": "네 주변에 너를 가장 응원해주는 사람은 누구야?", "insight": "주요 지지 자원 및 긍정적 대인관계 파악"},
        {"id": "B13", "level": 2, "text": "학교나 학원 외에, 네가 마음 편히 시간을 보낼 수 있는 곳이 있어?", "insight": "안전 기지(Safe Base) 및 스트레스 회피 공간 유무 확인"},
        {"id": "B14", "level": 2, "text": "1년 전의 나와 지금의 나를 비교하면, 가장 많이 달라진 점은 뭐야?", "insight": "변화에 대한 자기 인식 및 성장 또는 어려움에 대한 관점 탐색"},
        {"id": "B15", "level": 2, "text": "너의 하루 일과를 간단하게 설명해 줄 수 있어?", "insight": "전반적인 생활 리듬과 규칙성 파악"},

    # Level 3
        {"id": "B16", "level": 3, "text": "만약 투명인간이 될 수 있다면, 가장 먼저 뭘 하고 싶어?", "insight": "내면에 숨겨진 욕구 및 소망을 투사적 질문을 통해 탐색"},
        {"id": "B17", "level": 3, "text": "'나'라는 사람을 다른 사람들은 어떻게 생각할 것 같아?", "insight": "타인의 시선에 대한 인식 및 사회적 자아상 파악"},
        {"id": "B18", "level": 3, "text": "네 인생에서 가장 중요하게 생각하는 가치 3가지는 뭐야?", "insight": "핵심 가치관을 통해 의사결정 및 행동의 기준을 이해"},
        {"id": "B19", "level": 3, "text": "네가 가장 '나답다'고 느끼는 순간은 언제야?", "insight": "진정한 자기(True Self)에 대한 인식 및 자아 정체성 탐색"},
        {"id": "B20", "level": 3, "text": "만약 아무런 걱정 없이 딱 한 가지 소원을 빌 수 있다면, 어떤 소원을 빌고 싶어?", "insight": "가장 근원적인 결핍이나 소망을 파악하여 상담의 장기 목표 설정에 활용"}
    ],

    "PEER": [
        # Level 1
        {"id": "P01", "level": 1, "text": "요즘 가장 자주 만나거나 연락하는 친구는 누구야?", "insight": "주요 또래 관계 파악"},
        {"id": "P02", "level": 1, "text": "친한 친구들이랑은 주로 만나면 뭐하고 놀아?", "insight": "사회적 활동 패턴 및 관심사 파악"},
        {"id": "P03", "level": 1, "text": "최근에 친구 때문에 가장 크게 웃었던 일이 있다면 뭐야?", "insight": "긍정적 또래 관계 경험 탐색"},
        {"id": "P04", "level": 1, "text": "새로운 친구를 사귀는 건 나에게 쉬운 편이야, 아니면 어려운 편이야?", "insight": "사회적 상호작용에 대한 자신감/불안감 평가"},
        {"id": "P05", "level": 1, "text": "친구들 사이에서 나는 주로 어떤 역할인 것 같아? (분위기 메이커, 상담사, 조용한 편 등)", "insight": "또래 집단 내 자기 인식 및 역할 파악"},
        
        # Level 2
        {"id": "P06", "level": 2, "text": "친구와 의견이 다르거나 다퉜을 때, 보통 어떻게 해결하는 편이야?", "insight": "갈등 해결 방식 및 대인관계 기술 평가"},
        {"id": "P07", "level": 2, "text": "친구에게 고민을 털어놓는 편이야? 아니면 혼자 해결하려고 하는 편이야?", "insight": "또래 지지체계 활용도 및 신뢰 수준 파악"},
        {"id": "P08", "level": 2, "text": "친구들 사이에서 지켜야 하는 중요한 규칙이나 약속이 있다면 뭘까?", "insight": "또래 집단의 규범 및 소속감에 대한 이해도"},
        {"id": "P09", "level": 2, "text": "친구가 나만 빼고 다른 친구랑 더 친하게 지내서 서운했던 적이 있어?", "insight": "관계에서의 불안정성 및 질투/소외감 경험 탐색"},
        {"id": "P10", "level": 2, "text": "나는 친구들 사이에서 '인싸'에 가까운 것 같아, '아싸'에 가까운 것 같아?", "insight": "스스로 인지하는 사회적 위치 및 소속감"},
        {"id": "P11", "level": 2, "text": "친구가 어려운 부탁을 했을 때 거절을 잘 하는 편이야?", "insight": "자기 주장 및 거절 표현 능력 평가"},
        {"id": "P12", "level": 2, "text": "단톡방에서 내 이야기가 나올 때 어떤 기분이 들어?", "insight": "온라인 또래 관계에서의 민감도 및 반응"},
        {"id": "P13", "level": 2, "text": "친구의 SNS를 보면서 부러운 마음이 든 적이 있어?", "insight": "또래와의 사회적 비교 수준 파악"},
        {"id": "P14", "level": 2, "text": "나를 정말 잘 이해해준다고 느끼는 친구가 몇 명 정도 있어?", "insight": "친밀한 관계의 수 및 질적 수준 평가"},
        {"id": "P15", "level": 2, "text": "친구에게 돈을 빌려주거나 빌린 경험이 있어?", "insight": "친구 관계에서의 경제적 상호작용 및 신뢰 문제"},

        # Level 3
        {"id": "P16", "level": 3, "text": "친구가 나를 서운하게 했을 때, 그 마음을 솔직하게 말하는 편이야 아니면 그냥 참는 편이야?", "insight": "감정 표현 방식 및 관계 갈등 대처의 능동성/수동성"},
        {"id": "P17", "level": 3, "text": "친구들 무리에서 나만 소외되는 듯한 기분이 든다면, 그 이유는 무엇일까?", "insight": "소외감의 원인에 대한 자기 귀인 방식 파악"},
        {"id": "P18", "level": 3, "text": "나에게 '진짜 친구'란 어떤 의미인지 이야기해 줄 수 있을까?", "insight": "우정에 대한 가치관 및 관계 욕구 탐색"},
        {"id": "P19", "level": 3, "text": "친구 관계 때문에 학교 가기 싫다고 느낀 적이 있다면, 어떤 상황이었어?", "insight": "또래 관계가 학교 적응에 미치는 부정적 영향 평가"},
        {"id": "P20", "level": 3, "text": "혹시 너의 비밀이나 약점을 가지고 놀리거나 힘들게 하는 친구가 있어?", "insight": "관계적 공격성 및 정서적 괴롭힘 피해 경험 스크리닝"},
        # ... (P21 ~ P30 추가)
    ],
    "SCH": [
        # Level 1
        {"id": "S01", "level": 1, "text": "학교 생활하면 요즘 가장 먼저 떠오르는 단어는 뭐야?", "insight": "학교 생활에 대한 전반적 감정 톤 파악"},
        {"id": "S02", "level": 1, "text": "학교에서 가장 즐거운 시간과 가장 힘든 시간은 각각 언제야?", "insight": "학교 생활의 긍정/부정 요인 탐색"},
        {"id": "S03", "level": 1, "text": "급식 메뉴 중에 네 '최애' 메뉴는 뭐야?", "insight": "가벼운 주제로 라포 형성"},
        {"id": "S04", "level": 1, "text": "학교에서 너랑 가장 잘 통하는 선생님이 계셔?", "insight": "학교 내 성인 지지 자원 유무 확인"},
        {"id": "S05", "level": 1, "text": "학교 끝나고 집에 갈 때 보통 어떤 기분이야?", "insight": "하루의 학업 스트레스 수준 가늠"},

        # Level 2
        {"id": "S06", "level": 2, "text": "공부하다가 '이건 정말 어렵다' 싶은 과목이 있어?", "insight": "특정 학습 영역의 부진 및 어려움 파악"},
        {"id": "S07", "level": 2, "text": "수업 시간에 질문을 자유롭게 하는 편이야?", "insight": "수업 참여 태도 및 학업 자신감"},
        {"id": "S08", "level": 2, "text": "하루 평균 공부 시간은 어느 정도 돼? 충분하다고 생각해?", "insight": "학습 시간 및 자기 평가"},
        {"id": "S09", "level": 2, "text": "숙제가 너무 많다고 느낄 때가 있어?", "insight": "학업 부담 수준 평가"},
        {"id": "S10", "level": 2, "text": "시험 기간이 되면 평소보다 예민해지거나 잠을 설치는 편이야?", "insight": "시험 불안 수준 측정"},
        {"id": "S11", "level": 2, "text": "학교에서 지켜야 하는 규칙 중에 이건 좀 이상하다고 생각되는 게 있어?", "insight": "학교 권위 및 규칙에 대한 인식"},
        {"id": "S12", "level": 2, "text": "학교에서 동아리나 다른 활동을 하고 있는 게 있어?", "insight": "학업 외 활동을 통한 적응 및 흥미"},
        {"id": "S13", "level": 2, "text": "장래희망이나 가고 싶은 학과에 대해 생각해 본 적 있어?", "insight": "진로 탐색 수준 및 구체성"},
        {"id": "S14", "level": 2, "text": "결석이나 지각을 자주 하는 편이야?", "insight": "학교 출결을 통한 성실성 및 적응 문제"},
        {"id": "S15", "level": 2, "text": "수업 시간에 집중이 잘 안될 때가 많아?", "insight": "주의 집중력 문제 스크리닝"},

        # Level 3
        {"id": "S16", "level": 3, "text": "성적표를 받았을 때, 성적 자체보다 부모님의 반응이 더 걱정된 적이 있어?", "insight": "성취 압박감의 근원 탐색"},
        {"id": "S17", "level": 3, "text": "내가 원하는 진로와 부모님이 기대하는 진로가 달라서 고민한 적이 있어?", "insight": "진로 결정에서의 자율성 및 부모와의 갈등"},
        {"id": "S18", "level": 3, "text": "공부를 잘해야만 좋은 어른이 될 수 있을까?", "insight": "성적과 성공에 대한 가치관 탐색"},
        {"id": "S19", "level": 3, "text": "학교에 가기 싫어서 꾀병을 부린 적이 있다면, 그 이유는 뭐였어?", "insight": "등교 거부의 심층 원인 탐색"},
        {"id": "S20", "level": 3, "text": "앞으로 뭘 해야 할지 막막하게 느껴질 때가 자주 있어?", "insight": "미래에 대한 불안감 수준 심층 평가"},
    ],

    "HOME": [
    #Level 1
        {"id": "H01", "level": 1, "text": "집에 있을 때, 가장 편안하게 느껴지는 공간은 어디야?", "insight": "가정 내 안정감 및 개인 공간 확보 여부 파악"},
        {"id": "H02", "level": 1, "text": "최근에 가족들이랑 다 같이 모여서 웃었던 기억이 있다면 언제야?", "insight": "가족의 긍정적 상호작용 및 유대감 정도 탐색"},
        {"id": "H03", "level": 1, "text": "우리 가족을 한 단어로 표현한다면? (예: 시끌벅적, 조용함, 든든함, 전쟁터...)", "insight": "가족 전체 분위기에 대한 주관적 인식 파악"},
        {"id": "H04", "level": 1, "text": "가족 중에서 나랑 가장 대화가 잘 통하는 사람은 누구야?", "insight": "가족 내 주요 지지 자원 및 소통 채널 확인"},
        {"id": "H05", "level": 1, "text": "우리 집만의 특별한 규칙이나 습관이 있다면 소개해 줄래?", "insight": "가족의 문화 및 규칙에 대한 인식 파악"},
    
    #Level 2
        {"id": "H06", "level": 2, "text": "부모님이랑 가장 자주 이야기하는 주제와, 가장 피하게 되는 주제는 각각 뭐야?", "insight": "가족 내 소통의 개방성 및 금기시되는 주제 파악"},
        {"id": "H07", "level": 2, "text": "집에서 내가 맡은 역할이나 책임이 있어? (방 청소, 동생 돌보기 등)", "insight": "가족 체계 내에서의 역할 및 책임감 수준 파악"},
        {"id": "H08", "level": 2, "text": "부모님이 나의 스마트폰 사용이나 사생활에 대해 어디까지 알고 계시는 것 같아?", "insight": "자녀에 대한 감독 수준과 프라이버시 존중 정도 파악"},
        {"id": "H09", "level": 2, "text": "형제나 자매가 있다면, 사이는 좋은 편이야 아니면 자주 다투는 편이야?", "insight": "형제 관계의 질 및 갈등 수준 평가"},
        {"id": "H10", "level": 2, "text": "부모님이 나에게 가장 많이 하시는 칭찬과 잔소리는 각각 뭐야?", "insight": "주요 양육 태도(지지/통제)에 대한 청소년의 인식"},
        {"id": "H11", "level": 2, "text": "고민이 있을 때, 부모님께 먼저 이야기하는 편이야?", "insight": "부모가 정서적 지지 자원으로 기능하는지 여부 확인"},
        {"id": "H12", "level": 2, "text": "우리 가족의 경제적 상황에 대해 어느 정도 알고 있어?", "insight": "가정의 현실적 문제에 대한 인식 및 관여도"},
        {"id": "H13", "level": 2, "text": "부모님 두 분이 다투시는 모습을 본 적이 있어? 그때 어떤 기분이 들어?", "insight": "부부 갈등 노출 경험 및 이에 대한 정서적 반응"},
        {"id": "H14", "level": 2, "text": "집에 혼자 있는 시간이 많은 편이야?", "insight": "돌봄 공백 및 방임 가능성 초기 스크리닝"},
        {"id": "H15", "level": 2, "text": "내가 하는 일(공부, 취미 등)에 대해 부모님은 얼마나 응원해주시는 것 같아?", "insight": "자율성 및 성취에 대한 부모의 지지 수준 파악"},

    #Level 3
        {"id": "H16", "level": 3, "text": "부모님께 내 힘든 점을 솔직히 털어놓았을 때, 주로 어떤 반응을 보여주셔?", "insight": "청소년이 경험하는 부모의 정서적 수용도 평가"},
        {"id": "H17", "level": 3, "text": "'우리 집은 다른 집이랑 좀 다른 것 같다'고 느낄 때가 있다면 언제야?", "insight": "가족 내 독특성 및 소속감/이질감에 대한 인식"},
        {"id": "H18", "level": 3, "text": "부모님께 차마 말하지 못하고 숨기는 비밀이 있어?", "insight": "의사소통의 단절 및 숨겨진 내면의 문제 탐색"},
        {"id": "H19", "level": 3, "text": "혹시 집이 편안한 휴식 공간이라기보다, 스트레스를 받는 공간처럼 느껴질 때가 있어?", "insight": "가정이 스트레스 요인으로 작용하는지 여부 심층 평가"},
        {"id": "H20", "level": 3, "text": "만약 내가 정말 큰 실수를 저질렀을 때, 우리 부모님은 어떻게 반응하실 것 같아?", "insight": "실수와 실패에 대한 가족의 수용성 및 안전 기지 역할에 대한 믿음 파악"}
    ],
    "EMO": [
    # Level 1
        {"id": "E01", "level": 1, "text": "요즘 네 기분을 날씨로 표현한다면 어때? (맑음, 흐림, 비, 폭풍 등)", "insight": "현재 정서 상태를 비유적으로 표현하게 하여 심리적 저항을 낮추고 전반적인 기분 상태를 파악"},
        {"id": "E02", "level": 1, "text": "최근에 너를 가장 편안하고 기분 좋게 했던 일은 뭐야?", "insight": "긍정적 정서를 유발하는 요인과 안정감을 주는 활동 탐색"},
        {"id": "E03", "level": 1, "text": "요즘 가장 많이 듣는 노래가 있다면, 그 노래는 어떤 분위기야?", "insight": "선호하는 음악을 통해 현재의 정서 상태를 간접적으로 파악"},
        {"id": "E04", "level": 1, "text": "몸과 마음에 점수를 매긴다면, 각각 10점 만점에 몇 점을 줄 수 있을 것 같아?", "insight": "신체적, 정서적 건강에 대한 주관적인 자기 평가"},
        {"id": "E05", "level": 1, "text": "스트레스 받을 때 너를 위로해주는 음식이 있어?", "insight": "스트레스와 식습관의 연관성 및 대처 방식 탐색"},
    
    # Level 2
        {"id": "E06", "level": 2, "text": "밤에 잠은 잘 자는 편이야? 잠들기 전에 주로 무슨 생각을 해?", "insight": "수면의 질을 통해 건강 상태를 파악하고, 자기 전 사고 내용으로 불안 수준을 예측"},
        {"id": "E07", "level": 2, "text": "사소한 일에도 쉽게 짜증이 나거나 화가 날 때가 있어?", "insight": "정서 조절 능력 및 충동성 수준 평가"},
        {"id": "E08", "level": 2, "text": "최근 들어 입맛이 없거나, 반대로 평소보다 너무 많이 먹게 되는 경우가 있어?", "insight": "스트레스나 우울감이 식습관에 미치는 영향 파악"},
        {"id": "E09", "level": 2, "text": "특별히 아픈 곳은 없는데 몸이 무겁거나 피곤하다고 느낄 때가 자주 있어?", "insight": "정서적 문제가 신체 증상으로 나타나는 경향(신체화)을 스크리닝"},
        {"id": "E10", "level": 2, "text": "다른 사람들 앞에서는 괜찮은 척하지만, 혼자 있을 때 힘든 감정을 느낄 때가 있어?", "insight": "감정 표현의 억제 수준 및 내면의 어려움 정도 파악"},
        {"id": "E11", "level": 2, "text": "어떤 행동이나 물건에 집착하게 되거나, 특정 생각을 떨치기 어려웠던 적이 있어?", "insight": "강박적 사고나 행동의 가능성 탐색"},
        {"id": "E12", "level": 2, "text": "내 외모나 신체에 대해 마음에 들지 않아 속상했던 경험이 있어?", "insight": "신체상(Body Image) 및 외모 관련 스트레스 수준 파악"},
        {"id": "E13", "level": 2, "text": "아무것도 하기 싫고 무기력하게 느껴질 때가 얼마나 자주 있어?", "insight": "우울감의 주요 증상인 무기력감(anhedonia)의 빈도 및 강도 측정"},
        {"id": "E14", "level": 2, "text": "나도 모르게 손톱을 물어뜯거나 다리를 떠는 등의 습관이 있어?", "insight": "불안이나 긴장이 신체적 습관으로 나타나는지 여부 확인"},
        {"id": "E15", "level": 2, "text": "남들 앞에 서거나 발표할 때 심하게 긴장되거나 불안한 편이야?", "insight": "사회적 불안 및 수행 불안 수준 평가"},

    # Level 3
        {"id": "E16", "level": 3, "text": "왠지 모르게 갑자기 눈물이 나거나 울고 싶을 때가 있어?", "insight": "통제되지 않는 슬픔 표현을 통해 우울감 및 정서적 불안정성 심층 평가"},
        {"id": "E17", "level": 3, "text": "'이런 내 모습은 나만 알고 있을 거야' 하는 비밀스러운 감정이나 생각이 있어?", "insight": "타인에게 드러내지 않는 내면의 고민과 자기 인식 수준 탐색"},
        {"id": "E18", "level": 3, "text": "내가 왜 이런 감정을 느끼는지 스스로도 이해하기 어려울 때가 있어?", "insight": "자기 감정에 대한 인식(정서 인식) 및 이해 수준 평가"},
        {"id": "E19", "level": 3, "text": "나쁜 일이 생겼을 때, '전부 내 탓'이라고 생각하며 자책하는 편이야?", "insight": "부정적 사건에 대한 귀인 방식을 통해 낮은 자존감 및 우울 사고 패턴 파악"},
        {"id": "E20", "level": 3, "text": "나의 감정을 다른 사람에게 솔직하게 표현하는 것이 왜 어렵다고 느껴져?", "insight": "감정 표현의 어려움에 대한 심층적 원인 탐색"}
    ],
    "DIGI": [
    # Level 1
        {"id": "D01", "level": 1, "text": "요즘 제일 재미있게 하는 게임이나 자주 보는 유튜브 채널이 있다면 소개해 줘!", "insight": "관심사 파악 및 라포 형성, 또래 문화와의 연결성 확인"},
        {"id": "D02", "level": 1, "text": "네가 가장 많이 사용하는 앱(어플) 3가지는 뭐야?", "insight": "주요 디지털 활동 패턴 파악"},
        {"id": "D03", "level": 1, "text": "하루 중 스마트폰을 가장 많이 보게 되는 시간은 언제야?", "insight": "스마트폰 사용의 시간적 패턴 탐색"},
        {"id": "D04", "level": 1, "text": "온라인에서만 쓰는 별명이나 캐릭터 이름이 있어?", "insight": "온라인에서의 정체성 및 자기 표현 방식에 대한 가벼운 탐색"},
        {"id": "D05", "level": 1, "text": "온라인 게임을 할 때, 주로 혼자 하는 편이야 아니면 친구들이랑 같이 하는 편이야?", "insight": "게임의 사회적 기능(고립/관계 촉진) 파악"},
    
    # Level 2
        {"id": "D06", "level": 2, "text": "잠들기 직전까지 스마트폰을 보는 편이야? 스마트폰 때문에 잠을 설친 적도 있어?", "insight": "스마트폰 사용이 수면의 질에 미치는 영향 파악 및 과의존 스크리닝"},
        {"id": "D07", "level": 2, "text": "스마트폰을 하다가 '시간 낭비했다'고 후회하거나, 그만해야 하는데 계속 보게 된 적이 있어?", "insight": "스마트폰 사용에 대한 자기 통제력 및 문제 인식 수준 파악"},
        {"id": "D08", "level": 2, "text": "온라인에서 누군가의 댓글이나 메시지 때문에 기분이 상하거나 힘들었던 적이 있어?", "insight": "사이버불링 피해 경험 스크리닝"},
        {"id": "D09", "level": 2, "text": "부모님이 나의 스마트폰 사용 시간을 제한하거나 검사하려고 해서 다툰 적이 있어?", "insight": "디지털 기기 사용을 둘러싼 부모와의 갈등 수준 평가"},
        {"id": "D10", "level": 2, "text": "게임 아이템을 사거나 앱에서 결제해 본 경험이 있어? 주로 어떤 종류야?", "insight": "온라인에서의 소비 패턴 및 충동성 파악"},
        {"id": "D11", "level": 2, "text": "온라인에서 얼굴을 모르는 사람과 이야기해 본 적이 있어?", "insight": "온라인 익명 관계 형성 경험 및 잠재적 위험 노출도 탐색"},
        {"id": "D12", "level": 2, "text": "내 SNS 게시물에 '좋아요'가 몇 개 달리는지 신경 쓰이는 편이야?", "insight": "온라인에서의 사회적 인정 욕구 및 또래 평가에 대한 민감도 측정"},
        {"id": "D13", "level": 2, "text": "스마트폰이 없으면 불안하거나 심심해서 견디기 힘들 것 같아?", "insight": "스마트폰에 대한 심리적 의존도 평가"},
        {"id": "D14", "level": 2, "text": "현실의 나보다 온라인에서의 내 모습이 더 멋지거나 솔직하다고 느낄 때가 있어?", "insight": "온라인과 현실 자아의 괴리감 및 온라인 정체성의 중요도 파악"},
        {"id": "D15", "level": 2, "text": "유튜브나 틱톡 같은 영상을 보기 시작하면, 생각했던 것보다 훨씬 더 오랜 시간을 보게 돼?", "insight": "숏폼 콘텐츠(Short-form contents) 시청 조절의 어려움 및 중독성 문제 탐색"},

    # Level 3
        {"id": "D16", "level": 3, "text": "SNS 속 친구들의 행복해 보이는 모습을 보면서, 내 모습과 비교되어 우울해진 적이 있어?", "insight": "디지털 환경에서의 사회적 비교가 자존감에 미치는 영향 심층 평가"},
        {"id": "D17", "level": 3, "text": "온라인 세상에 너무 빠져서, 현실의 친구 관계나 학업에 소홀해진다고 느낀 적이 있다면 언제야?", "insight": "디지털 과의존이 현실 기능에 미치는 부정적 영향에 대한 자기 인식 수준"},
        {"id": "D18", "level": 3, "text": "만약 내가 온라인에 올린 글이나 사진 때문에 누군가 상처를 받았다면 어떨 것 같아?", "insight": "온라인 행동의 책임감 및 공감 능력 수준 측정"},
        {"id": "D19", "level": 3, "text": "현실에서는 하기 힘든 말을 온라인에서는 쉽게 하게 되는 이유는 무엇이라고 생각해?", "insight": "온라인의 익명성이 자기 표현에 미치는 영향에 대한 심층적 사고 탐색"},
        {"id": "D20", "level": 3, "text": "스마트폰이나 게임이 없다면, 내 하루가 어떻게 달라질 것 같아?", "insight": "디지털 활동의 대체 가능성 및 현실 활동에 대한 동기 수준 파악"}
    ],
    "RISK": [
    # Level 1
        {"id": "R01", "level": 1, "text": "요즘 학교나 동네가 안전하다고 느껴져?", "insight": "주변 환경의 안전성에 대한 주관적 인식 파악"},
        {"id": "R02", "level": 1, "text": "화나거나 짜증날 때, '이건 정말 하면 안된다'고 생각하는 행동이 있어?", "insight": "공격적 행동에 대한 내적 통제 및 규범 인식 수준 탐색"},
        {"id": "R03", "level": 1, "text": "너만의 스트레스 해소법이 있다면 뭐야?", "insight": "위험 행동의 대체재가 될 수 있는 긍정적 대처 자원 파악"},
        {"id": "R04", "level": 1, "text": "위험한 상황에 처했을 때 도움을 청할 수 있는 어른이 주변에 있어?", "insight": "위기 상황에서의 사회적 지지체계 및 안전망 유무 확인"},
        {"id": "R05", "level": 1, "text": "최근에 본 영화나 드라마에서 가장 인상 깊었던 싸움 장면이 있어?", "insight": "폭력에 대한 미디어 노출 및 인식을 가볍게 탐색하며 라포 형성"},
        
    # Level 2
        {"id": "R06", "level": 2, "text": "누군가 너를 지속적으로 괴롭히거나 힘들게 하는 사람이 있어?", "insight": "학교 폭력 및 다양한 형태의 괴롭힘 피해 경험 직접 스크리닝"},
        {"id": "R07", "level": 2, "text": "반대로, 네가 누군가를 따돌리거나 괴롭히는 일에 참여해 본 적이 있어?", "insight": "폭력 및 괴롭힘 가해 경험 스크리닝"},
        {"id": "R08", "level": 2, "text": "친구가 위험한 행동(흡연, 음주 등)을 하자고 했을 때 거절해 본 경험이 있어?", "insight": "위험한 또래 압력에 대한 저항 및 자기주장 능력 평가"},
        {"id": "R09", "level": 2, "text": "최근에 누군가와 주먹다짐을 하거나 심하게 다툰 적이 있어?", "insight": "물리적 폭력의 가해/피해 경험 파악"},
        {"id": "R10", "level": 2, "text": "혹시 돈이나 물건을 빼앗긴 경험이 있어?", "insight": "금품 갈취 피해 경험 스크리닝"},
        {"id": "R11", "level": 2, "text": "밤늦게 혼자 집에 들어가거나 다닐 때 무섭다고 느낀 적이 있어?", "insight": "지역 사회 안전에 대한 불안감 및 위험 노출도 평가"},
        {"id": "R12", "level": 2, "text": "온라인에서 누군가 너에게 무서운 메시지를 보내거나 개인정보를 물어본 적이 있어?", "insight": "온라인 그루밍 등 사이버 성범죄 위험 노출도 스크리닝"},
        {"id": "R13", "level": 2, "text": "가족에게 맞거나 아주 심한 말을 들어서 상처받은 경험이 있어?", "insight": "가정 내 신체적/정서적 학대 피해 경험 스크리닝"},
        {"id": "R14", "level": 2, "text": "나쁜 일이 생길 것 같다는 불안한 생각 때문에 힘들 때가 있어?", "insight": "범불안 증상 및 위험에 대한 과도한 경계심 파악"},
        {"id": "R15", "level": 2, "text": "아무 이유 없이 일부러 위험한 행동(무단횡단, 높은 곳에 올라가기 등)을 해 본 적이 있어?", "insight": "충동성 및 자기 파괴적 행동 경향성 탐색"},

    # Level 3
        {"id": "R16", "level": 3, "text": "너무 힘들어서 나 자신을 일부러 아프게 하거나 상처를 낸 경험이 있어? (예: 팔을 긋거나 머리를 때리는 등)", "insight": "비자살적 자해 행동(NSSI) 경험을 직접적으로 확인하여 위기 개입 필요성 평가"},
        {"id": "R17", "level": 3, "text": "모든 것을 끝내고 싶다는 생각, 즉 죽고 싶다는 생각이 든 적이 있다면 얼마나 자주, 그리고 어떤 상황에서 그런 생각이 들어?", "insight": "자살 사고의 빈도, 강도, 구체성을 파악하여 자살 위험도를 심층적으로 평가"},
        {"id": "R18", "level": 3, "text": "누군가를 너무 미워해서 심하게 다치게 하거나 해치고 싶다는 상상을 해 본 적이 있어?", "insight": "타해(homicidal ideation) 사고 및 공격성의 심각도 탐색"},
        {"id": "R19", "level": 3, "text": "내가 겪은 힘든 일에 대해 어른들에게 이야기해도 아무도 도와주지 않을 것이라고 생각한 적이 있어?", "insight": "성인 및 사회적 지원 시스템에 대한 불신 및 고립감 심층 평가"},
        {"id": "R20", "level": 3, "text": "만약 지금 당장 위험한 상황에 처한다면, 가장 먼저 무엇을 할 것 같아?", "insight": "위기 상황에서의 대처 능력 및 즉각적인 안전 계획 수립 여부 확인"}
]
    
    # 총 7개 질문 카테고리 (기본, 가정, 교우, 학업, 정서, 디지털, 안전)
}


class QuestionGenerator:
    def __init__(self):
        self.question_bank = QUESTION_BANK

    def generate_question_set(self, category: str, count: int = 5) -> list:
        """
        한 세션을 위한 질문 5개 세트를 '1-3-1 깔때기' 구조로 생성합니다.
        """
        if category not in self.question_bank:
            return []

        level1_qs = [q for q in self.question_bank[category] if q['level'] == 1]
        level2_qs = [q for q in self.question_bank[category] if q['level'] == 2]
        level3_qs = [q for q in self.question_bank[category] if q['level'] == 3]

        question_set = []

        # 1. Level 1에서 1개 선택
        if level1_qs:
            question_set.extend(random.sample(level1_qs, min(len(level1_qs), 1)))

        # 2. Level 2에서 3개 선택
        if level2_qs:
            question_set.extend(random.sample(level2_qs, min(len(level2_qs), 3)))

        # 3. Level 3에서 1개 선택
        if level3_qs:
            question_set.extend(random.sample(level3_qs, min(len(level3_qs), 1)))

        # 만약 총 5개가 안되면, 남은 레벨에서 채움
        while len(question_set) < count:
            remaining_qs = [q for q in self.question_bank[category] if q not in question_set]
            if not remaining_qs:
                break
            question_set.append(random.choice(remaining_qs))

        return question_set[:count]