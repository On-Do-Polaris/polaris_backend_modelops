# íƒœí’ AAL ë¯¸ë˜ ë…„ë„ ê³„ì‚° êµ¬í˜„ ê³„íš

> **ì‘ì„±ì¼**: 2025-11-23
> **ëª©ì **: Best Track ê³¼ê±° ë°ì´í„°ì™€ KMA SSP ì‹œë‚˜ë¦¬ì˜¤ë¥¼ í™œìš©í•œ ë¯¸ë˜ íŠ¹ì • ë…„ë„ íƒœí’ AAL ê³„ì‚° ë°©ë²•ë¡ 
> **ë²„ì „**: 3.0 (ë‹¨ì¼ ëª…í™• ë¡œì§)

---

## ğŸ“š í•µì‹¬ ê³¼í•™ì  ê·¼ê±° ìš”ì•½

ë³¸ ë°©ë²•ë¡ ì€ ë‹¤ìŒì˜ **êµ­ì œì ìœ¼ë¡œ ì¸ì •ë°›ì€ ê³¼í•™ì  ê·¼ê±°**ì— ê¸°ë°˜í•©ë‹ˆë‹¤:

### ê¸°í›„ë³€í™”-íƒœí’ ê°•ë„ ê´€ê³„
- **IPCC AR6 (2021)**: 2Â°C ì˜¨ë‚œí™” ì‹œ íƒœí’ ê°•ë„ **1-10% ì¦ê°€** (ì¤‘-ë†’ì€ ì‹ ë¢°ë„) [IPCC-1]
- **Tran et al. (2022)**: SSP5-8.5 ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ **17% ê°•ë„ ì¦ê°€** (CMIP6 ê¸°ë°˜) [TRAN-1]
- **Emanuel (2007)**: íƒœí’ ê°•ë„ì™€ í•´ìˆ˜ë©´ ì˜¨ë„ ê°„ **ë†’ì€ ìƒê´€ê´€ê³„** ì…ì¦ [EMANUEL-1]

### AAL ê¸°í›„ë³€í™” ì¡°ì •
- **Marsooli et al. (2024)**: +2Â°C ì˜¨ë‚œí™” ì‹œ AAL **10% ì¦ê°€** [MARSOOLI-1]
- **Knutson et al. (2020)**: 11ëª… ì „ë¬¸ê°€ ì¤‘ 10ëª…ì´ íƒœí’ ê°•ë„ ì¦ê°€ ì˜ˆì¸¡ (ì¤‘-ë†’ì€ ì‹ ë¢°ë„) [KNUTSON-1]

### ë°ì´í„° í‘œì¤€
- **WMO Typhoon Committee**: TD/TS/STS/TY ë¶„ë¥˜ ê¸°ì¤€ ë° Best Track í‘œì¤€ [WMO-1, WMO-2]
- **IBTrACS**: WMO ê³µì¸ êµ­ì œ Best Track ì•„ì¹´ì´ë¸Œ [IBTRACS-1]
- **KMA**: ê³µì‹ íƒœí’ Best Track ì•Œê³ ë¦¬ì¦˜ ë° SSP ì‹œë‚˜ë¦¬ì˜¤ (1km í•´ìƒë„) [KMA-1, KMA-3]

### ìœ„í—˜í‰ê°€ í”„ë ˆì„ì›Œí¬
- **TCFD (2017)**: ê¸°í›„ ê´€ë ¨ ì¬ë¬´ ê³µì‹œ ê¶Œê³ ì•ˆ - íƒœí’ì„ ê¸‰ì„± ë¬¼ë¦¬ì  ë¦¬ìŠ¤í¬ë¡œ ë¶„ë¥˜ [TCFD-1]
- **Verisk AIR & UNESCAP**: AAL = Î£(Loss Ã— Probability) í‘œì¤€ ë°©ë²•ë¡  [AIR-1, UNESCAP-1]

> ğŸ“– **ìƒì„¸ ë ˆí¼ëŸ°ìŠ¤:** ì„¹ì…˜ 9 ì°¸ì¡° (30+ í•™ìˆ  ë¬¸í—Œ ë° ê³µì‹ ë¬¸ì„œ)

---

## 1. ë¬¸ì œ ì •ì˜

### 1.1 í˜„ì¬ ìƒí™©

**ë³´ìœ  ë°ì´í„°:**
- âœ… **Best Track ë°ì´í„°** (2015-2024): ê³¼ê±° íƒœí’ ë°œìƒ ê¸°ë¡, 6ì‹œê°„ ê°„ê²© ìœ„ì¹˜/ë“±ê¸‰/ê°•í’ë°˜ê²½
- âœ… **KMA SSP ì‹œë‚˜ë¦¬ì˜¤ ë°ì´í„°** (2021-2100): ê¸°ì˜¨(TA), ê°•ìˆ˜(RN), í’ì†(WS), ìŠµë„(RHM) ë“± ê¸°í›„ ë³€ìˆ˜
- âŒ **ë¯¸ë˜ íƒœí’ íŠ¸ë™ ì‹œë®¬ë ˆì´ì…˜**: ì—†ìŒ

**ë‹¤ë¥¸ ë¦¬ìŠ¤í¬ ì²˜ë¦¬ ë°©ì‹:**
- í­ì—¼(WSDI), í•œíŒŒ(CSDI), í™ìˆ˜(RX1DAY) ë“±ì€ KMA NetCDFì—ì„œ **ë…„ë„ë³„ ì§€í‘œë¥¼ ì§ì ‘ ì¶”ì¶œ**
- `BaseProbabilityAgent` í”„ë ˆì„ì›Œí¬ë¥¼ í†µí•´ í†µì¼ëœ ì¸í„°í˜ì´ìŠ¤ë¡œ AAL ê³„ì‚°

**íƒœí’ì˜ íŠ¹ìˆ˜ì„±:**
- Best Trackì€ **ê³¼ê±°ë§Œ** ì¡´ì¬
- KMA ì‹œë‚˜ë¦¬ì˜¤ì—ëŠ” **íƒœí’ íŠ¸ë™ì´ í¬í•¨ë˜ì§€ ì•ŠìŒ**
- í•˜ì§€ë§Œ íƒœí’ ê°•ë„/ë¹ˆë„ì— ì˜í–¥ì„ ì£¼ëŠ” **ê¸°í›„ ë³€ìˆ˜**(ê¸°ì˜¨, ìŠµë„ ë“±)ëŠ” í¬í•¨

### 1.2 ìš”êµ¬ì‚¬í•­

- [ ] 4ê°œ SSP ì‹œë‚˜ë¦¬ì˜¤ (SSP126, SSP245, SSP370, SSP585) ê°ê°ì— ëŒ€í•´
- [ ] 2021-2100ë…„ **ë…„ë„ë³„** íƒœí’ AAL ê³„ì‚° ê°€ëŠ¥
- [ ] ë‹¤ë¥¸ ë¦¬ìŠ¤í¬ì™€ **ë™ì¼í•œ ì¸í„°í˜ì´ìŠ¤** ìœ ì§€ (`BaseProbabilityAgent` ì¤€ìˆ˜)
- [ ] íŠ¹ì • ê¸°ê°„(ì˜ˆ: 2041-2060)ì˜ í‰ê·  AAL ì¶”ì¶œ ê°€ëŠ¥

---

## 2. í•´ê²° ë°©ì•ˆ: Hybrid Approach

### 2.1 í•µì‹¬ ì•„ì´ë””ì–´

**3ë‹¨ê³„ ì ‘ê·¼ë²•:**

1. **ê³¼ê±° í†µê³„ í•™ìŠµ**: Best Track(2015-2024)ì—ì„œ íƒœí’ ë…¸ì¶œ ì§€ìˆ˜ S_tcì˜ í†µê³„ì  ë¶„í¬ ì¶”ì¶œ
2. **ê¸°í›„ ìŠ¤ì¼€ì¼ë§**: KMA ì‹œë‚˜ë¦¬ì˜¤ì˜ ê¸°ì˜¨ ë³€í™”ë¥¼ í™œìš©í•´ ë…„ë„ë³„ íƒœí’ ê°•ë„ ìŠ¤ì¼€ì¼ë§
3. **í™•ë¥ ì  ì‹œë®¬ë ˆì´ì…˜**: ë…„ë„ë³„ S_tcë¥¼ í†µê³„ì ìœ¼ë¡œ ìƒì„±í•˜ì—¬ ë‹¤ë¥¸ ë¦¬ìŠ¤í¬ì™€ ë™ì¼í•œ ì…ë ¥ í˜•íƒœ ì œê³µ

### 2.2 ê³¼í•™ì  ê·¼ê±°

#### 2.2.1 ê¸°í›„ë³€í™”ì™€ íƒœí’ ê°•ë„ ê´€ê³„ (IPCC AR6)

**ì¶œì²˜:** IPCC AR6 WG1 Chapter 11 (2021), Section 11.7.1 Tropical Cyclones
- **PDF:** https://www.ipcc.ch/report/ar6/wg1/downloads/report/IPCC_AR6_WGI_Chapter11.pdf (p.1585-)

**í•µì‹¬ ë°œê²¬:**
1. **ê°•ë„ ì¦ê°€ (High Confidence):**
   - "Tropical cyclone intensities globally are projected to increase (medium to high confidence) on average (**by 1 to 10% according to model projections for a 2Â°C global warming**)"
   - ë³¸ êµ¬í˜„ì—ì„œëŠ” **ë³´ìˆ˜ì ìœ¼ë¡œ 4%/Â°C** ì ìš© (ë²”ìœ„ ì¤‘ê°„ê°’)

2. **ê°•ìˆ˜ëŸ‰ ì¦ê°€:**
   - "Peak tropical cyclone rain rates increase with local warming at least at the rate of mean water vapour increase over oceans (**about 7% per 1Â°C of warming**)"
   - "Modeling studies on average project an increase by **about 14% (+6 to +22%) globally for rainfall** rates averaged within about 100 km of the storm for a 2Â°C global warming scenario"

3. **Category 4-5 ì¦ê°€:**
   - "The proportion of intense tropical cyclones (Category 4-5) and peak wind speeds of the most intense tropical cyclones are projected to increase at the global scale with increasing global warming (**high confidence**)"

#### 2.2.2 SSP ì‹œë‚˜ë¦¬ì˜¤ë³„ ì •ëŸ‰ì  ì˜ˆì¸¡

**ì¶œì²˜:** Tran et al. (2022), Future Changes in Tropical Cyclone Exposure in Southeast Asia, Earth's Future, 10, doi:10.1029/2022EF003118

**CMIP6 ê¸°ë°˜ ì˜ˆì¸¡ (2071-2100 vs 1985-2014):**
- **SSP2-4.5:** TCs will be **9.5% more intense**
- **SSP5-8.5:** TCs will be **17% more intense**
- ë³¸ êµ¬í˜„ì˜ ìŠ¤ì¼€ì¼ë§ ê³„ìˆ˜ (4%/Â°C)ëŠ” ì´ ë²”ìœ„ì™€ ì¼ê´€ë¨

#### 2.2.3 AAL ê¸°í›„ë³€í™” ì¡°ì •

**ì¶œì²˜:** Marsooli et al. (2024), Increase in insurance losses caused by North Atlantic hurricanes in a warmer climate, Communications Earth & Environment, 5:562

**ì •ëŸ‰ì  AAL ì¦ê°€:**
- **+2Â°C ì˜¨ë‚œí™”:** Expected changes in average annual loss are **10%**
- **+4Â°C ì˜¨ë‚œí™”:** Expected changes in average annual loss are **15%**
- ê°•ìˆ˜ ê¸°ì—¬ë„ê°€ ê°€ì¥ í° ì¦ê°€ ìš”ì¸

#### 2.2.4 ì˜¨ë„-íƒœí’ ê°•ë„ ë©”ì»¤ë‹ˆì¦˜

**ì¶œì²˜:** Emanuel (2007), Environmental Factors Affecting Tropical Cyclone Power Dissipation, Journal of Climate, 20(22):5497-5509

**Potential Intensity Theory:**
- "The record of net hurricane power dissipation is **highly correlated with tropical sea surface temperature**, reflecting well-documented climate signals"
- **ëŒ€ê¸° ì¤‘ ê¸°ì˜¨ì„ í•´ìˆ˜ë©´ ì˜¨ë„(SST)ì˜ proxyë¡œ í™œìš© ê°€ëŠ¥** - ìƒê´€ê´€ê³„ ë†’ìŒ

**ì¶œì²˜:** Knutson et al. (2020), Tropical Cyclones and Climate Change Assessment Part II, BAMS, 101(3):E303-E322

**ì¢…í•© í‰ê°€:**
- "For TC intensity, 10 of 11 authors had at least **medium-to-high confidence** that the global average will increase"
- 2Â°C ì˜¨ë‚œí™” ì‹œë‚˜ë¦¬ì˜¤ì— ëŒ€í•œ êµ¬ì²´ì  ì˜ˆì¸¡ ì œê³µ

#### 2.2.5 í†µê³„ì  ì ‘ê·¼ë²• íƒ€ë‹¹ì„±

**ì¶œì²˜:** Sobel et al. (2016), Human influence on tropical cyclone intensity, Science, 353(6296):242-246

**ë¯¸ë˜ ì˜ˆì¸¡ ë°©ë²•ë¡ :**
- "Future greenhouse gas forcing of potential intensity will increasingly dominate over aerosol forcing, leading to **substantially larger increases in tropical cyclone intensities**"
- ì˜¨ë„ ê¸°ë°˜ ìŠ¤ì¼€ì¼ë§ ì ‘ê·¼ë²•ì˜ ê³¼í•™ì  ê·¼ê±° ì œê³µ

**ê³¼ê±° ë³€ë™ì„± ìœ ì§€ì˜ ì¤‘ìš”ì„±:**
- íƒœí’ ë°œìƒì˜ **ë…„ë„ë³„ ë¶ˆê·œì¹™ì„±** ë°˜ì˜ í•„ìš” (ë³¸ êµ¬í˜„ì˜ Gamma ë¶„í¬ ìƒ˜í”Œë§)

---

## 3. ìƒì„¸ êµ¬í˜„ ë°©ë²•

### Phase 1: Baseline í†µê³„ ì¶”ì¶œ

#### 3.1.1 ê³¼ê±° S_tc ê³„ì‚°

Best Track 2015-2024 ë°ì´í„°ì—ì„œ ê° ë…„ë„ë³„ ë…¸ì¶œ ì§€ìˆ˜ ê³„ì‚°:

```python
def calculate_historical_S_tc(typhoon_tracks, site_location):
    """
    ê³¼ê±° Best Track ë°ì´í„°ì—ì„œ ì—°ë„ë³„ íƒœí’ ë…¸ì¶œ ì§€ìˆ˜ ê³„ì‚°

    Args:
        typhoon_tracks: List[{year, storm_id, tracks: [...]}]
        site_location: {lon, lat}

    Returns:
        {2015: S_tc_2015, 2016: S_tc_2016, ..., 2024: S_tc_2024}

    WMO íƒœí’ ë¶„ë¥˜ ê¸°ì¤€ (Western Pacific):
    - TD (Tropical Depression): < 17 m/s (< 34 knots)
    - TS (Tropical Storm): 17-24 m/s (34-47 knots)
    - STS (Severe Tropical Storm): 25-32 m/s (48-63 knots)
    - TY (Typhoon): â‰¥ 33 m/s (â‰¥ 64 knots)

    ì¶œì²˜: WMO Typhoon Committee Operational Manual (WMO/TD-No. 196)
    URL: https://www.typhooncommittee.org/
    """
    w_tc = [0, 1, 3, 6]  # bin ê°€ì¤‘ì¹˜: [ë¬´ì˜í–¥, TS, STS, TY]
    yearly_exposure = {}

    for storm in typhoon_tracks:
        year = storm['year']
        if year not in yearly_exposure:
            yearly_exposure[year] = 0.0

        for track_point in storm['tracks']:
            # ì‚¬ì´íŠ¸ê°€ ê°•í’/í­í’ íƒ€ì› ë‚´ë¶€ì¸ì§€ íŒì •
            bin_inst = calculate_bin_inst(track_point, site_location)
            yearly_exposure[year] += w_tc[bin_inst]

    return yearly_exposure
```

#### 3.1.2 í†µê³„ì  íŠ¹ì„± ì¶”ì¶œ

```python
def extract_baseline_statistics(historical_S_tc):
    """
    Returns:
        {
            'mean': float,
            'std': float,
            'distribution': 'gamma',  # S_tc >= 0 ì´ë¯€ë¡œ Gamma ì í•©
            'fit_params': {'shape': k, 'scale': theta}
        }
    """
    values = list(historical_S_tc.values())

    baseline_mean = np.mean(values)
    baseline_std = np.std(values)

    # Gamma ë¶„í¬ í”¼íŒ… (S_tcëŠ” í•­ìƒ >= 0)
    shape = (baseline_mean / baseline_std) ** 2
    scale = baseline_std ** 2 / baseline_mean

    return {
        'mean': baseline_mean,
        'std': baseline_std,
        'distribution': 'gamma',
        'fit_params': {'shape': shape, 'scale': scale}
    }
```

**ì˜ˆìƒ ê²°ê³¼ (ëŒ€ì „ ê¸°ì¤€):**
```python
{
    'mean': 8.5,          # ì—°í‰ê·  ë…¸ì¶œ ì§€ìˆ˜
    'std': 12.3,          # í‘œì¤€í¸ì°¨ (ë³€ë™ì„± í¼)
    'distribution': 'gamma',
    'fit_params': {'shape': 0.48, 'scale': 17.7}
}
```

---

### Phase 2: KMA ì‹œë‚˜ë¦¬ì˜¤ ê¸°ë°˜ ìŠ¤ì¼€ì¼ë§

#### 3.2.1 ë…„ë„ë³„ ê°•ë„ ìŠ¤ì¼€ì¼ë§ ê³„ì‚° (ê¸°ì˜¨ ê¸°ë°˜)

ë³¸ êµ¬í˜„ì€ **ê¸°ì˜¨(TA) ë‹¨ì¼ ë³€ìˆ˜ë§Œ ì‚¬ìš©**í•©ë‹ˆë‹¤. ì´ëŠ” ë‹¤ìŒ ì´ìœ  ë•Œë¬¸ì…ë‹ˆë‹¤:
- IPCC AR6ì—ì„œ ê°€ì¥ ëª…í™•í•œ ê³¼í•™ì  ê·¼ê±° í™•ë³´
- KMA ì‹œë‚˜ë¦¬ì˜¤ ë°ì´í„°ì—ì„œ ì•ˆì •ì ìœ¼ë¡œ ì œê³µ
- í•´ìˆ˜ë©´ ì˜¨ë„(SST)ì˜ proxyë¡œ ì‚¬ìš© ê°€ëŠ¥ (Emanuel, 2007)

```python
def calculate_intensity_scaling(scenario, year, kma_loader, baseline_temp):
    """
    íŠ¹ì • ì‹œë‚˜ë¦¬ì˜¤/ë…„ë„ì˜ ê¸°í›„ ì¡°ê±´ì—ì„œ íƒœí’ ê°•ë„ ìŠ¤ì¼€ì¼ë§ ê³„ì‚°

    ê³µì‹: intensity_scale = 1.0 + 0.04 Ã— (year_temp - baseline_temp)

    Args:
        scenario: 'SSP126', 'SSP245', 'SSP370', 'SSP585'
        year: 2021-2100
        kma_loader: KMAScenarioDataLoader ì¸ìŠ¤í„´ìŠ¤
        baseline_temp: ê³¼ê±° í‰ê·  ê¸°ì˜¨ (2015-2024)

    Returns:
        intensity_scale: float (1.0 = baseline, >1.0 = ê°•í™”)

    ê³¼í•™ì  ê·¼ê±°:
    - IPCC AR6: 2Â°C ì˜¨ë‚œí™” ì‹œ íƒœí’ ê°•ë„ 1-10% ì¦ê°€
    - ë³¸ êµ¬í˜„: 1Â°Cë‹¹ 4% ì¦ê°€ (ë²”ìœ„ ì¤‘ê°„ê°’, ë³´ìˆ˜ì )
    """
    # KMA ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ í•´ë‹¹ ë…„ë„ ì›”ë³„ ê¸°ì˜¨ ë¡œë“œ
    ta_monthly = kma_loader.load_monthly(scenario, 'TA', year)

    # ì—°í‰ê·  ê¸°ì˜¨
    year_avg_temp = np.mean(ta_monthly)

    # ê¸°ì¤€ ëŒ€ë¹„ ì˜¨ë„ ìƒìŠ¹ë¶„
    temp_increase = year_avg_temp - baseline_temp

    # IPCC ê¸°ë°˜ ìŠ¤ì¼€ì¼ë§ (1Â°C â†’ 4% ê°•ë„ ì¦ê°€)
    intensity_scale = 1.0 + 0.04 * temp_increase

    # ê·¹ë‹¨ê°’ ë°©ì§€ (0.8 ~ 1.5 ë²”ìœ„ë¡œ ì œí•œ)
    return max(0.8, min(1.5, intensity_scale))
```

**ì˜ˆì‹œ ê³„ì‚°:**
```python
# SSP585, 2050ë…„
baseline_temp = 14.2Â°C  # 2015-2024 í‰ê· 
year_2050_temp = 16.8Â°C  # SSP585 ì‹œë‚˜ë¦¬ì˜¤
temp_increase = 2.6Â°C
intensity_scale = 1.0 + 0.04 Ã— 2.6 = 1.104

# SSP126, 2050ë…„
year_2050_temp = 15.1Â°C
temp_increase = 0.9Â°C
intensity_scale = 1.0 + 0.04 Ã— 0.9 = 1.036
```

---

### Phase 3: ë…„ë„ë³„ S_tc ì‹œë®¬ë ˆì´ì…˜

#### 3.3.1 í™•ë¥ ì  ìƒ˜í”Œë§

```python
def generate_future_S_tc(scenario, years_range, baseline_stats, kma_loader, seed=42):
    """
    ë¯¸ë˜ ë…„ë„ë³„ S_tc ì‹œë®¬ë ˆì´ì…˜

    Args:
        scenario: 'SSP126' ë“±
        years_range: (2021, 2100)
        baseline_stats: Phase 1ì—ì„œ ì¶”ì¶œí•œ í†µê³„
        kma_loader: KMA ë°ì´í„° ë¡œë”
        seed: ì¬í˜„ì„±ì„ ìœ„í•œ ëœë¤ ì‹œë“œ

    Returns:
        np.array([S_tc_2021, S_tc_2022, ..., S_tc_2100])
    """
    np.random.seed(seed)

    simulated_S_tc = []

    for year in range(years_range[0], years_range[1] + 1):
        # í•´ë‹¹ ë…„ë„ì˜ ê°•ë„ ìŠ¤ì¼€ì¼ë§
        scale = calculate_intensity_scaling(scenario, year, kma_loader, ...)

        # ìŠ¤ì¼€ì¼ë§ëœ ê¸°ëŒ€ê°’
        expected_mean = baseline_stats['mean'] * scale

        # Gamma ë¶„í¬ì—ì„œ ìƒ˜í”Œë§ (ë³€ë™ì„± ìœ ì§€)
        # E[X] = shape Ã— scale
        # Var[X] = shape Ã— scaleÂ²
        # ë³€ë™ì„±ì€ ìœ ì§€í•˜ë©´ì„œ í‰ê· ë§Œ ì¡°ì •
        shape = baseline_stats['fit_params']['shape']
        scale_param = expected_mean / shape

        sampled = np.random.gamma(shape, scale_param)

        # ìŒìˆ˜ ë°©ì§€ ë° ê·¹ë‹¨ê°’ ì œí•œ
        sampled = max(0, min(sampled, baseline_stats['mean'] * 3))

        simulated_S_tc.append(sampled)

    return np.array(simulated_S_tc)
```

**ì˜ˆìƒ ì¶œë ¥:**
```python
# SSP126, 2021-2100
[6.2, 11.5, 3.8, 15.2, ..., 9.8, 18.3]  # 80ê°œ ê°’

# SSP585, 2021-2100
[7.1, 13.2, 5.5, 18.9, ..., 22.5, 31.2]  # í‰ê· ì ìœ¼ë¡œ ë” ë†’ì€ ê°’
```

---

### Phase 4: BaseProbabilityAgent ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„

#### 3.4.1 TyphoonProbabilityAgent í™•ì¥

```python
class TyphoonProbabilityAgent(BaseProbabilityAgent):
    """íƒœí’ ë…¸ì¶œ ê¸°ë°˜ í™•ë¥  ê³„ì‚° - ë¯¸ë˜ ì‹œë‚˜ë¦¬ì˜¤ ì§€ì›"""

    def __init__(self):
        bins = [
            (0, 0),           # bin1: ë…¸ì¶œ ì—†ìŒ
            (0, 5),           # bin2: ì•½í•œ ë…¸ì¶œ
            (5, 15),          # bin3: ì¤‘ê°„~ê°•í•œ ë…¸ì¶œ
            (15, float('inf'))  # bin4: ë§¤ìš° ê°•í•œ ë…¸ì¶œ
        ]
        dr_intensity = [0.00, 0.02, 0.10, 0.30]

        super().__init__(
            risk_type='íƒœí’',
            bins=bins,
            dr_intensity=dr_intensity,
            time_unit='yearly'
        )

        # Baseline í†µê³„ ì €ì¥
        self.baseline_stats = None
        self.baseline_temp = None

    def initialize_baseline(self, historical_tracks, site_location):
        """
        ê³¼ê±° Best Track ë°ì´í„°ë¡œ baseline ì´ˆê¸°í™”
        (ìµœì´ˆ 1íšŒë§Œ í˜¸ì¶œ)
        """
        # S_tc ê³„ì‚°
        historical_S_tc = calculate_historical_S_tc(
            historical_tracks,
            site_location
        )

        # í†µê³„ ì¶”ì¶œ
        self.baseline_stats = extract_baseline_statistics(historical_S_tc)

        # ê³¼ê±° í‰ê·  ê¸°ì˜¨ (ìŠ¤ì¼€ì¼ë§ ê¸°ì¤€)
        # ë³„ë„ë¡œ ê³„ì‚°í•˜ê±°ë‚˜ ì œê³µë°›ìŒ
        self.baseline_temp = 14.2  # ì˜ˆì‹œ

        self.logger.info(f"Baseline ì´ˆê¸°í™” ì™„ë£Œ: mean={self.baseline_stats['mean']:.2f}")

    def calculate_intensity_indicator(self, collected_data):
        """
        BaseProbabilityAgentì˜ ì¶”ìƒ ë©”ì„œë“œ êµ¬í˜„

        Input í˜•ì‹ (2ê°€ì§€ ëª¨ë“œ):

        1) ê³¼ê±° ëª¨ë“œ:
        {
            'typhoon_data': {
                'typhoon_tracks': [...],
                'site_location': {'lon': ..., 'lat': ...}
            }
        }

        2) ë¯¸ë˜ ì‹œë‚˜ë¦¬ì˜¤ ëª¨ë“œ:
        {
            'future_scenario': {
                'scenario': 'SSP126',
                'years': (2021, 2100),
                'kma_data_loader': KMADataLoader(...),
                'site_location': {'lon': ..., 'lat': ...}
            }
        }

        Output: np.array of S_tc values (ë…„ë„ë³„)
        """

        # ê³¼ê±° ëª¨ë“œ
        if 'typhoon_data' in collected_data:
            typhoon_data = collected_data['typhoon_data']

            historical_S_tc = calculate_historical_S_tc(
                typhoon_data['typhoon_tracks'],
                typhoon_data['site_location']
            )

            # Baseline ìë™ ì´ˆê¸°í™”
            if self.baseline_stats is None:
                self.initialize_baseline(
                    typhoon_data['typhoon_tracks'],
                    typhoon_data['site_location']
                )

            # dict â†’ array ë³€í™˜
            years = sorted(historical_S_tc.keys())
            return np.array([historical_S_tc[y] for y in years])

        # ë¯¸ë˜ ì‹œë‚˜ë¦¬ì˜¤ ëª¨ë“œ
        elif 'future_scenario' in collected_data:
            scenario_info = collected_data['future_scenario']

            # Baseline ì²´í¬
            if self.baseline_stats is None:
                raise ValueError(
                    "Baselineì´ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. "
                    "ë¨¼ì € initialize_baseline()ì„ í˜¸ì¶œí•˜ì„¸ìš”."
                )

            # S_tc ì‹œë®¬ë ˆì´ì…˜
            return generate_future_S_tc(
                scenario=scenario_info['scenario'],
                years_range=scenario_info['years'],
                baseline_stats=self.baseline_stats,
                kma_loader=scenario_info['kma_data_loader'],
                seed=42  # ì¬í˜„ì„±
            )

        else:
            raise ValueError("ìœ íš¨í•˜ì§€ ì•Šì€ ì…ë ¥ í˜•ì‹")
```

#### 3.4.2 ë‹¤ë¥¸ ë¦¬ìŠ¤í¬ì™€ ë™ì¼í•œ ì‚¬ìš© íŒ¨í„´

```python
# === í­ì—¼ (ê¸°ì¡´ ë¦¬ìŠ¤í¬) ===
heat_agent = HighTemperatureProbabilityAgent()
heat_result = heat_agent.calculate_probability({
    'climate_data': {
        'wsdi': load_yearly_data("SSP126_WSDI_yearly_2021-2100.nc", "WSDI")
    }
})

# === íƒœí’ (ìƒˆë¡œ êµ¬í˜„) ===
typhoon_agent = TyphoonProbabilityAgent()

# 1. Baseline ì´ˆê¸°í™” (ìµœì´ˆ 1íšŒ)
typhoon_agent.initialize_baseline(
    historical_tracks=load_best_track_data(2015, 2024),
    site_location={'lon': 127.38, 'lat': 36.35}
)

# 2. ë¯¸ë˜ ì‹œë‚˜ë¦¬ì˜¤ ê³„ì‚°
kma_loader = KMAScenarioDataLoader(KMA_DATA_DIR, site_location)

typhoon_result = typhoon_agent.calculate_probability({
    'future_scenario': {
        'scenario': 'SSP126',
        'years': (2021, 2100),
        'kma_data_loader': kma_loader,
        'site_location': {'lon': 127.38, 'lat': 36.35}
    }
})

# === ë‘ ê²°ê³¼ ëª¨ë‘ ë™ì¼í•œ êµ¬ì¡° ===
# {
#     'bin_probabilities': [0.65, 0.20, 0.10, 0.05],
#     'bin_base_damage_rates': [0.00, 0.02, 0.10, 0.30],
#     'calculation_details': {...}
# }
```

---

### Phase 5: 4ê°œ ì‹œë‚˜ë¦¬ì˜¤ ì¼ê´„ ì²˜ë¦¬

#### 3.5.1 ì „ì²´ ì‹œë‚˜ë¦¬ì˜¤ AAL ê³„ì‚°

```python
def calculate_all_scenarios_aal(
    baseline_tracks,
    site_location,
    kma_data_dir,
    periods=None
):
    """
    4ê°œ SSP ì‹œë‚˜ë¦¬ì˜¤ì— ëŒ€í•œ íƒœí’ AAL ê³„ì‚°

    Args:
        baseline_tracks: 2015-2024 Best Track ë°ì´í„°
        site_location: {'lon': ..., 'lat': ...}
        kma_data_dir: KMA NetCDF íŒŒì¼ ë””ë ‰í† ë¦¬
        periods: None or [(2021,2040), (2041,2060), (2061,2100)]

    Returns:
        {
            'SSP126': {'aal': 0.0184, 'bin_probabilities': [...], ...},
            'SSP245': {'aal': 0.0220, ...},
            'SSP370': {'aal': 0.0265, ...},
            'SSP585': {'aal': 0.0318, ...}
        }
    """
    scenarios = ['SSP126', 'SSP245', 'SSP370', 'SSP585']
    results = {}

    # 1. Agent ì´ˆê¸°í™” ë° Baseline ì„¤ì •
    agent = TyphoonProbabilityAgent()
    agent.initialize_baseline(baseline_tracks, site_location)

    # 2. KMA ë°ì´í„° ë¡œë”
    kma_loader = KMAScenarioDataLoader(kma_data_dir, site_location)

    # 3. ê° ì‹œë‚˜ë¦¬ì˜¤ë³„ ê³„ì‚°
    for scenario in scenarios:
        # ì „ì²´ ê¸°ê°„ (2021-2100)
        result_full = agent.calculate_probability({
            'future_scenario': {
                'scenario': scenario,
                'years': (2021, 2100),
                'kma_data_loader': kma_loader,
                'site_location': site_location
            }
        })

        # AAL ê³„ì‚°
        aal_full = sum(
            p * dr
            for p, dr in zip(
                result_full['bin_probabilities'],
                result_full['bin_base_damage_rates']
            )
        )

        results[scenario] = {
            'bin_probabilities': result_full['bin_probabilities'],
            'bin_base_damage_rates': result_full['bin_base_damage_rates'],
            'aal': aal_full
        }

        # ê¸°ê°„ë³„ ì„¸ë¶„í™” (ì„ íƒ)
        if periods:
            results[scenario]['periods'] = {}
            for period in periods:
                result_period = agent.calculate_probability({
                    'future_scenario': {
                        'scenario': scenario,
                        'years': period,
                        'kma_data_loader': kma_loader,
                        'site_location': site_location
                    }
                })

                aal_period = sum(
                    p * dr
                    for p, dr in zip(
                        result_period['bin_probabilities'],
                        result_period['bin_base_damage_rates']
                    )
                )

                period_key = f"{period[0]}-{period[1]}"
                results[scenario]['periods'][period_key] = {
                    'bin_probabilities': result_period['bin_probabilities'],
                    'aal': aal_period
                }

    return results
```

#### 3.5.2 ì‚¬ìš© ì˜ˆì‹œ

```python
# Best Track ë°ì´í„° ë¡œë“œ
baseline_tracks = load_all_best_track_data(
    typhoon_dir="./typhoon/",
    years=range(2015, 2025)
)

# ëŒ€ì „ ìœ„ì¹˜
daejeon_site = {'lon': 127.38, 'lat': 36.35}

# 4ê°œ ì‹œë‚˜ë¦¬ì˜¤ AAL ê³„ì‚°
results = calculate_all_scenarios_aal(
    baseline_tracks=baseline_tracks,
    site_location=daejeon_site,
    kma_data_dir="./KMA/",
    periods=[(2021, 2040), (2041, 2060), (2061, 2100)]
)

# ê²°ê³¼ ì¶œë ¥
for scenario, data in results.items():
    print(f"{scenario}: AAL = {data['aal']:.4f} ({data['aal']*100:.2f}%)")
    for period_key, period_data in data.get('periods', {}).items():
        print(f"  {period_key}: AAL = {period_data['aal']:.4f}")
```

---

## 4. KMA Data Loader êµ¬í˜„

### 4.1 ê³µí†µ ë°ì´í„° ë¡œë” í´ë˜ìŠ¤

ëª¨ë“  ë¦¬ìŠ¤í¬ê°€ ê³µìœ í•˜ëŠ” KMA NetCDF ë°ì´í„° ë¡œë”:

```python
class KMAScenarioDataLoader:
    """KMA SSP ì‹œë‚˜ë¦¬ì˜¤ NetCDF ë°ì´í„° ë¡œë”"""

    def __init__(self, data_dir, site_location):
        """
        Args:
            data_dir: KMA NetCDF íŒŒì¼ ë””ë ‰í† ë¦¬ ê²½ë¡œ
            site_location: {'lon': float, 'lat': float}
        """
        self.data_dir = Path(data_dir)
        self.site_lon = site_location['lon']
        self.site_lat = site_location['lat']

        # ìºì‹œ (ë™ì¼ íŒŒì¼ ì¬ë¡œë“œ ë°©ì§€)
        self._cache = {}

    def _get_nearest_idx(self, lat_arr, lon_arr):
        """ì‚¬ì´íŠ¸ì— ê°€ì¥ ê°€ê¹Œìš´ ê·¸ë¦¬ë“œ ì¸ë±ìŠ¤ ì°¾ê¸°"""
        lat_idx = np.argmin(np.abs(lat_arr - self.site_lat))
        lon_idx = np.argmin(np.abs(lon_arr - self.site_lon))
        return lat_idx, lon_idx

    def load_yearly(self, scenario, variable, years=None):
        """
        ì—°ë„ë³„ ë³€ìˆ˜ ë¡œë“œ

        ì‚¬ìš© ê°€ëŠ¥í•œ ë³€ìˆ˜ (4ê°œ SSP ì‹œë‚˜ë¦¬ì˜¤ ê³µí†µ):

        ê·¹í•œì§€ìˆ˜ - ê³ ì˜¨:
        - 'WSDI': Warm Spell Duration Index (í­ì—¼ ì§€ì†ê¸°ê°„)
        - 'HW33': 33Â°C ì´ìƒ ì¼ìˆ˜
        - 'SU25': í•˜ë£¨ ìµœê³ ê¸°ì˜¨ 25Â°C ì´ìƒ ì¼ìˆ˜
        - 'TR25': ì—´ëŒ€ì•¼ ì¼ìˆ˜
        - 'TX90P', 'TN90P': 90ë°±ë¶„ìœ„ìˆ˜ ì´ˆê³¼ ì¼ìˆ˜

        ê·¹í•œì§€ìˆ˜ - ì €ì˜¨:
        - 'CSDI': Cold Spell Duration Index (í•œíŒŒ ì§€ì†ê¸°ê°„)
        - 'FD0': ê²°ë¹™ì¼ ìˆ˜
        - 'ID0': ì–¼ìŒì¼ ìˆ˜
        - 'TX10P', 'TN10P': 10ë°±ë¶„ìœ„ìˆ˜ ë¯¸ë§Œ ì¼ìˆ˜

        ê·¹í•œì§€ìˆ˜ - ê°•ìˆ˜:
        - 'RX1DAY': ì—° ìµœëŒ€ 1ì¼ ê°•ìˆ˜ëŸ‰ (mm)
        - 'RX5DAY': ì—° ìµœëŒ€ 5ì¼ ê°•ìˆ˜ëŸ‰ (mm)
        - 'RAIN80': ì‹œê°„ë‹¹ 80mm ì´ìƒ ê°•ìˆ˜ ë°œìƒ ì¼ìˆ˜
        - 'CDD': ì—°ì† ë¬´ê°•ìˆ˜ ì¼ìˆ˜

        ê¸°íƒ€:
        - 'TA', 'TAMAX', 'TAMIN': ê¸°ì˜¨ (Yearly aggregated)
        - 'RHM', 'WS', 'RN', 'SI': ê¸°ë³¸ ìš”ì†Œ (Yearly aggregated)

        Args:
            scenario: 'SSP126', 'SSP245', 'SSP370', 'SSP585'
            variable: ìœ„ ë³€ìˆ˜ ì¤‘ í•˜ë‚˜
            years: None (ì „ì²´) or (2021, 2100) or [2050, 2051, ...]

        Returns:
            np.array of yearly values (2021-2100, 80ë…„)
        """
        filename = f"{scenario}_{variable}_gridraw_yearly_2021-2100.nc"
        filepath = self.data_dir / filename

        if not filepath.exists():
            raise FileNotFoundError(
                f"íŒŒì¼ ì—†ìŒ: {filepath}\n"
                f"ì‚¬ìš© ê°€ëŠ¥í•œ Yearly ë³€ìˆ˜: WSDI, CSDI, RX1DAY, RAIN80, HW33, SU25, TR25 ë“±"
            )

        # ìºì‹œ ì²´í¬
        cache_key = f"{scenario}_{variable}_yearly"
        if cache_key in self._cache:
            data = self._cache[cache_key]
        else:
            ds = nc.Dataset(filepath)
            lat_arr = ds.variables['latitude'][:]
            lon_arr = ds.variables['longitude'][:]
            lat_idx, lon_idx = self._get_nearest_idx(lat_arr, lon_arr)

            data = ds.variables[variable][:, lat_idx, lon_idx]
            ds.close()

            if hasattr(data, 'data'):
                data = data.data

            self._cache[cache_key] = np.array(data, dtype=float)
            data = self._cache[cache_key]

        # ë…„ë„ í•„í„°ë§
        if years is None:
            return data  # 2021-2100 ì „ì²´ (80ë…„)
        elif isinstance(years, tuple):
            start_idx = years[0] - 2021
            end_idx = years[1] - 2021 + 1
            return data[start_idx:end_idx]
        else:
            indices = [y - 2021 for y in years]
            return data[indices]

    def load_monthly(self, scenario, variable, years=None):
        """
        ì›”ë³„ ë³€ìˆ˜ ë¡œë“œ

        ì‚¬ìš© ê°€ëŠ¥í•œ ë³€ìˆ˜ (4ê°œ SSP ì‹œë‚˜ë¦¬ì˜¤ ê³µí†µ):
        - 'TA': í‰ê·  ê¸°ì˜¨ (Â°C)
        - 'TAMAX': ìµœê³  ê¸°ì˜¨ (Â°C)
        - 'TAMIN': ìµœì € ê¸°ì˜¨ (Â°C)
        - 'RHM': ìƒëŒ€ìŠµë„ (%)
        - 'WS': í’ì† (m/s)
        - 'RN': ê°•ìˆ˜ëŸ‰ (mm)
        - 'SI': ì¼ì‚¬ëŸ‰
        - 'SPEI12': ê°€ë­„ì§€ìˆ˜ (12ê°œì›”)
        - 'PET': ì ì¬ì¦ë°œì‚°

        Args:
            scenario: 'SSP126', 'SSP245', 'SSP370', 'SSP585'
            variable: ìœ„ ë³€ìˆ˜ ì¤‘ í•˜ë‚˜
            years: None (ì „ì²´) or (2021, 2100) or 2050 (ë‹¨ì¼ ë…„ë„)

        Returns:
            np.array of monthly values (2021-2100, 960ê°œì›”)
        """
        # ì‚¬ìš© ê°€ëŠ¥í•œ ë³€ìˆ˜ ì²´í¬
        available_vars = ['TA', 'TAMAX', 'TAMIN', 'RHM', 'WS', 'RN', 'SI', 'SPEI12', 'PET']
        if variable not in available_vars:
            raise ValueError(
                f"ë³€ìˆ˜ '{variable}'ëŠ” ì‚¬ìš© ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. "
                f"ì‚¬ìš© ê°€ëŠ¥: {available_vars}"
            )

        # Grid Raw íŒŒì¼ëª… (SSP ì‹œë‚˜ë¦¬ì˜¤ë§Œ ì‚¬ìš©)
        filename = f"{scenario}_{variable}_gridraw_monthly_2021-2100.nc"
        filepath = self.data_dir / filename

        if not filepath.exists():
            raise FileNotFoundError(f"íŒŒì¼ ì—†ìŒ: {filepath}")

        # ìºì‹œ ì²´í¬
        cache_key = f"{scenario}_{variable}_monthly"
        if cache_key in self._cache:
            data = self._cache[cache_key]
        else:
            ds = nc.Dataset(filepath)
            lat_arr = ds.variables['latitude'][:]
            lon_arr = ds.variables['longitude'][:]
            lat_idx, lon_idx = self._get_nearest_idx(lat_arr, lon_arr)

            data = ds.variables[variable][:, lat_idx, lon_idx]
            ds.close()

            if hasattr(data, 'data'):
                data = data.data

            self._cache[cache_key] = np.array(data, dtype=float)
            data = self._cache[cache_key]

        # ë…„ë„ í•„í„°ë§
        if years is None:
            return data  # 2021-2100 ì „ì²´ (960ê°œì›”)
        elif isinstance(years, tuple):
            start_month = (years[0] - 2021) * 12
            end_month = (years[1] - 2021 + 1) * 12
            return data[start_month:end_month]
        elif isinstance(years, int):
            # ë‹¨ì¼ ë…„ë„
            start_month = (years - 2021) * 12
            return data[start_month:start_month + 12]
        else:
            raise ValueError(f"ìœ íš¨í•˜ì§€ ì•Šì€ years í˜•ì‹: {years}")

    def get_yearly_average(self, scenario, variable, year):
        """íŠ¹ì • ë…„ë„ì˜ ì›”ë³„ ë°ì´í„° ì—°í‰ê· """
        monthly = self.load_monthly(scenario, variable, year)
        return np.mean(monthly)
```

---

## 5. ìµœì¢… ì¶œë ¥ í˜•ì‹

### 5.1 ì „ì²´ ê¸°ê°„ (2021-2100)

```python
{
    'SSP126': {
        'bin_probabilities': [0.6500, 0.2000, 0.1000, 0.0500],
        'bin_base_damage_rates': [0.00, 0.02, 0.10, 0.30],
        'aal': 0.0184,  # 1.84%
        'calculation_details': {
            'scenario': 'SSP126',
            'years': (2021, 2100),
            'n_years': 80,
            'baseline_mean': 8.5,
            'avg_intensity_scale': 1.042
        }
    },
    'SSP245': {
        'aal': 0.0220,
        # ...
    },
    'SSP370': {
        'aal': 0.0265,
        # ...
    },
    'SSP585': {
        'aal': 0.0318,
        # ...
    }
}
```

### 5.2 ê¸°ê°„ë³„ ì„¸ë¶„í™”

```python
{
    'SSP126': {
        'aal': 0.0184,
        'periods': {
            '2021-2040': {
                'bin_probabilities': [0.67, 0.19, 0.09, 0.05],
                'aal': 0.0165
            },
            '2041-2060': {
                'bin_probabilities': [0.65, 0.20, 0.10, 0.05],
                'aal': 0.0180
            },
            '2061-2100': {
                'bin_probabilities': [0.62, 0.21, 0.11, 0.06],
                'aal': 0.0195
            }
        }
    },
    # ... ë‹¤ë¥¸ ì‹œë‚˜ë¦¬ì˜¤
}
```

### 5.3 ë‹¤ë¥¸ ë¦¬ìŠ¤í¬ì™€ì˜ í†µí•© ì¶œë ¥

```python
# ëª¨ë“  ë¦¬ìŠ¤í¬ AAL ê³„ì‚° ê²°ê³¼
all_risks_aal = {
    'heat': {
        'SSP126': {'aal': 0.0042, ...},
        'SSP245': {'aal': 0.0051, ...},
        # ...
    },
    'cold': {
        'SSP126': {'aal': 0.0018, ...},
        # ...
    },
    'flood': {...},
    'drought': {...},
    'wildfire': {...},
    'water_scarcity': {...},
    'typhoon': {
        'SSP126': {'aal': 0.0184, ...},
        'SSP245': {'aal': 0.0220, ...},
        'SSP370': {'aal': 0.0265, ...},
        'SSP585': {'aal': 0.0318, ...}
    }
}

# ì´ AAL (ì·¨ì•½ì„± ë°˜ì˜ ì „ baseë§Œ)
total_aal = {
    'SSP126': sum(all_risks_aal[risk]['SSP126']['aal'] for risk in all_risks_aal),
    'SSP245': sum(...),
    'SSP370': sum(...),
    'SSP585': sum(...)
}
```

---

## 6. êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸

### 6.1 ì½”ë“œ ìˆ˜ì •/ì¶”ê°€

- [ ] **typhoon_probability_agent.py**
  - [ ] `calculate_historical_S_tc()` í•¨ìˆ˜ ì¶”ê°€
  - [ ] `extract_baseline_statistics()` í•¨ìˆ˜ ì¶”ê°€
  - [ ] `calculate_intensity_scaling()` í•¨ìˆ˜ ì¶”ê°€
  - [ ] `generate_future_S_tc()` í•¨ìˆ˜ ì¶”ê°€
  - [ ] `TyphoonProbabilityAgent.initialize_baseline()` ë©”ì„œë“œ ì¶”ê°€
  - [ ] `TyphoonProbabilityAgent.calculate_intensity_indicator()` ì˜¤ë²„ë¼ì´ë“œ ìˆ˜ì •

- [ ] **kma_data_loader.py** (ì‹ ê·œ íŒŒì¼)
  - [ ] `KMAScenarioDataLoader` í´ë˜ìŠ¤ êµ¬í˜„
  - [ ] `load_yearly()` ë©”ì„œë“œ
  - [ ] `load_monthly()` ë©”ì„œë“œ
  - [ ] `get_yearly_average()` ë©”ì„œë“œ

- [ ] **typhoon_aal_calculator.py** (ì‹ ê·œ íŒŒì¼, ì„ íƒ)
  - [ ] `calculate_all_scenarios_aal()` í•¨ìˆ˜
  - [ ] `calculate_period_aal()` í•¨ìˆ˜

### 6.2 í…ŒìŠ¤íŠ¸

- [ ] **test_probability_agents.py í™•ì¥**
  - [ ] ê³¼ê±° ëª¨ë“œ í…ŒìŠ¤íŠ¸ (2015-2024 Best Track)
  - [ ] ë¯¸ë˜ ì‹œë‚˜ë¦¬ì˜¤ ëª¨ë“œ í…ŒìŠ¤íŠ¸ (SSP126)
  - [ ] 4ê°œ ì‹œë‚˜ë¦¬ì˜¤ ì¼ê´„ í…ŒìŠ¤íŠ¸
  - [ ] ê¸°ê°„ë³„ AAL í…ŒìŠ¤íŠ¸
  - [ ] Baseline í†µê³„ ì¶”ì¶œ ê²€ì¦

- [ ] **í†µí•© í…ŒìŠ¤íŠ¸**
  - [ ] ë‹¤ë¥¸ ë¦¬ìŠ¤í¬(heat, cold ë“±)ì™€ ë™ì¼í•œ ì¶œë ¥ í˜•ì‹ í™•ì¸
  - [ ] KMA ë°ì´í„° ë¡œë” ê³µìœ  í…ŒìŠ¤íŠ¸

### 6.3 ë¬¸ì„œ ì—…ë°ì´íŠ¸

- [ ] **aal_final_logic_v2.md**
  - [ ] ì„¹ì…˜ 9 (íƒœí’) ì—…ë°ì´íŠ¸
  - [ ] ë¯¸ë˜ ì¶”ì • ë°©ë²•ë¡  ì¶”ê°€
  - [ ] ìˆ˜ì‹ ë° íŒŒë¼ë¯¸í„° ëª…ì‹œ

- [ ] **README ë˜ëŠ” ì‚¬ìš© ê°€ì´ë“œ**
  - [ ] 4ê°œ ì‹œë‚˜ë¦¬ì˜¤ ì‚¬ìš©ë²•
  - [ ] Baseline ì´ˆê¸°í™” ë°©ë²•
  - [ ] ì˜ˆì œ ì½”ë“œ

---

## 7. ê²€ì¦ ë°©ë²•

### 7.1 ê³¼ê±° ê¸°ê°„ ê²€ì¦

```python
# 2015-2024 ì‹¤ì¸¡ AAL
historical_result = agent.calculate_probability({
    'typhoon_data': {
        'typhoon_tracks': load_best_track_data(2015, 2024),
        'site_location': daejeon_site
    }
})
historical_aal = calculate_aal(historical_result)

# 2015-2024 ì‹œë®¬ë ˆì´ì…˜ AAL (ë™ì¼ ê¸°ì˜¨ ì¡°ê±´)
# â†’ ê±°ì˜ ìœ ì‚¬í•´ì•¼ í•¨
```

### 7.2 ì‹œë‚˜ë¦¬ì˜¤ ê°„ ì¼ê´€ì„±

```python
# SSP126 < SSP245 < SSP370 < SSP585 ìˆœì„œ í™•ì¸
assert aal['SSP126'] < aal['SSP245'] < aal['SSP370'] < aal['SSP585']
```

### 7.3 ë¯¼ê°ë„ ë¶„ì„

```python
# ê¸°ì˜¨ ìƒìŠ¹ 1Â°Cë‹¹ AAL ì¦ê°€ìœ¨
for temp_coeff in [0.03, 0.04, 0.05]:
    aal = calculate_with_coeff(temp_coeff)
    # ê²°ê³¼ ë¹„êµ
```

---

## 8. ì°¸ê³  ë¬¸í—Œ

### 8.1 IPCC ë³´ê³ ì„œ

**[IPCC-1]** IPCC, 2021: Chapter 11 - Weather and Climate Extreme Events in a Changing Climate. In: Climate Change 2021: The Physical Science Basis. Contribution of Working Group I to the Sixth Assessment Report of the Intergovernmental Panel on Climate Change [Masson-Delmotte, V., et al. (eds.)]. Cambridge University Press.
- **PDF:** https://www.ipcc.ch/report/ar6/wg1/downloads/report/IPCC_AR6_WGI_Chapter11.pdf
- **Section 11.7.1:** Tropical Cyclones (p.1585-)
- **í•µì‹¬ ì¸ìš©:**
  - íƒœí’ ê°•ë„: 2Â°C ì˜¨ë‚œí™” ì‹œ 1-10% ì¦ê°€ (ì¤‘-ë†’ì€ ì‹ ë¢°ë„)
  - ê°•ìˆ˜ëŸ‰: 7% ì¦ê°€/Â°C (í•´ì–‘ ìˆ˜ì¦ê¸° ì¦ê°€ìœ¨)
  - Category 4-5 ë¹„ìœ¨ ì¦ê°€ (ë†’ì€ ì‹ ë¢°ë„)

### 8.2 íƒœí’-ê¸°í›„ë³€í™” ê´€ê³„

**[KNUTSON-1]** Knutson, T., et al., 2020: Tropical Cyclones and Climate Change Assessment: Part II: Projected Response to Anthropogenic Warming. Bulletin of the American Meteorological Society, 101(3), E303-E322.
- **DOI:** 10.1175/BAMS-D-18-0194.1
- **URL:** https://journals.ametsoc.org/view/journals/bams/101/3/bams-d-18-0194.1.xml
- **í•µì‹¬ ë°œê²¬:**
  - TC ê°•ë„: 11ëª… ì €ì ì¤‘ 10ëª…ì´ ì¤‘-ë†’ì€ ì‹ ë¢°ë„ë¡œ ì „ì§€êµ¬ í‰ê·  ì¦ê°€ ì˜ˆì¸¡
  - TC ê°•ìˆ˜ëŸ‰: 14% ì¦ê°€ (ì¤‘ê°„ê°’), ì¤‘-ë†’ì€ ì‹ ë¢°ë„

**[EMANUEL-1]** Emanuel, K.A., 2007: Environmental Factors Affecting Tropical Cyclone Power Dissipation. Journal of Climate, 20(22), 5497-5509.
- **DOI:** 10.1175/2007JCLI1571.1
- **URL:** https://journals.ametsoc.org/view/journals/clim/20/22/2007jcli1571.1.xml
- **í•µì‹¬ ì´ë¡ :** Potential Intensity Theory - íƒœí’ ê°•ë„ì™€ í•´ìˆ˜ë©´ ì˜¨ë„ ê°„ ë†’ì€ ìƒê´€ê´€ê³„

**[SOBEL-1]** Sobel, A.H., Camargo, S.J., Hall, T.M., Lee, C.-Y., Tippett, M.K., and Wing, A.A., 2016: Human influence on tropical cyclone intensity. Science, 353(6296), 242-246.
- **DOI:** 10.1126/science.aaf6574
- **í•µì‹¬ ë°œê²¬:** ë¯¸ë˜ ì˜¨ì‹¤ê°€ìŠ¤ ê°•ì œë ¥ì´ ì—ì–´ë¡œì¡¸ íš¨ê³¼ë¥¼ ì••ë„í•˜ì—¬ íƒœí’ ê°•ë„ ì‹¤ì§ˆì  ì¦ê°€

### 8.3 SSP ì‹œë‚˜ë¦¬ì˜¤ë³„ íƒœí’ ì˜ˆì¸¡

**[TRAN-1]** Tran, T.L., et al., 2022: Future Changes in Tropical Cyclone Exposure and Impacts in Southeast Asia From CMIP6 Pseudo-Global Warming Simulations. Earth's Future, 10(2), e2022EF003118.
- **DOI:** 10.1029/2022EF003118
- **ì •ëŸ‰ì  ì˜ˆì¸¡ (2071-2100 vs 1985-2014):**
  - SSP2-4.5: 9.5% ê°•ë„ ì¦ê°€
  - SSP5-8.5: 17% ê°•ë„ ì¦ê°€
- **ì ìš©:** ë³¸ êµ¬í˜„ì˜ 4%/Â°C ìŠ¤ì¼€ì¼ë§ ê³„ìˆ˜ ê²€ì¦

**[YAMAGUCHI-1]** Yamaguchi, R., et al., 2020: Reduced tropical cyclone densities and ocean effects due to anthropogenic greenhouse warming. Science Advances, 6(48), eabd3243.
- **DOI:** 10.1126/sciadv.abd3243
- **í•µì‹¬ ë°œê²¬:** ìƒë¥™ íƒœí’ì˜ í’ì† ë° ê°•ìˆ˜ëŸ‰ ê°•í™” (ê³ ì‹ ë¢°ë„ ì˜ˆì¸¡)

### 8.4 AAL ê³„ì‚° ë°©ë²•ë¡ 

**[MARSOOLI-1]** Marsooli, R., Lin, N., and Schubert, J., 2024: Increase in insurance losses caused by North Atlantic hurricanes in a warmer climate. Communications Earth & Environment, 5, Article 562.
- **DOI:** 10.1038/s43247-024-01824-7
- **ì •ëŸ‰ì  AAL ì¦ê°€:**
  - +2Â°C ì˜¨ë‚œí™”: 10% AAL ì¦ê°€
  - +4Â°C ì˜¨ë‚œí™”: 15% AAL ì¦ê°€
  - ê°•ìˆ˜ ê¸°ì—¬ë„ê°€ ìµœëŒ€ ì¦ê°€ ìš”ì¸

**[AIR-1]** Verisk AIR Worldwide, 2013: Modeling Fundamentals: What Is AAL? AIR Currents.
- **URL:** https://www.air-worldwide.com/models/tropical-cyclone/
- **AAL ì •ì˜:** ì†ì‹¤ì´ˆê³¼í™•ë¥ (EP) ë¶„í¬ì˜ í‰ê· ê°’, ì—°í‰ê·  ê¸°ëŒ€ì†ì‹¤
- **êµ¬ì„±ìš”ì†Œ:** Hazard, Exposure, Vulnerability, Financial Modules

**[UNESCAP-1]** UNESCAP, 2019: Annex 1.1: Average Annual Loss (AAL) methodology. Asia-Pacific Disaster Report 2019.
- **URL:** https://www.unescap.org/sites/default/files/APDR%202019%20Annexes_0.pdf
- **AAL ê³µì‹:** AAL = Î£ (Loss Ã— Probability) over all simulated events

### 8.5 WMO ë° Best Track í‘œì¤€

**[WMO-1]** WMO/ESCAP, 2025: Typhoon Committee Operational Manual. WMO/TD-No. 196 (TCP-23), Edition 2025.
- **URL:** https://www.typhooncommittee.org/57th/docs/item%207/TCP-23EDITION2025_20250207.pdf
- **íƒœí’ ë¶„ë¥˜ ê¸°ì¤€:** TD/TS/STS/TY í’ì† ì„ê³„ê°’ ì •ì˜

**[WMO-2]** WMO, 2025: Global Guide to Tropical Cyclone Forecasting, Chapter 2.
- **URL:** https://cyclone.wmo.int/pdf/Chapter-Two.pdf
- **Best Track ì •ì˜:** 6ì‹œê°„ ê°„ê²© íƒœí’ ìœ„ì¹˜, ê°•ë„, ìµœëŒ€í’ì†, ìµœì €ê¸°ì••ì˜ ì£¼ê´€ì  í‰í™œí™” í‘œí˜„

**[IBTRACS-1]** Knapp, K.R., et al., 2010 (updated 2025): The International Best Track Archive for Climate Stewardship (IBTrACS). Bulletin of the American Meteorological Society, 91, 363-376.
- **Official Site:** https://www.ncei.noaa.gov/products/international-best-track-archive
- **Technical Details:** https://www.ncei.noaa.gov/sites/g/files/anmtlf171/files/2025-04/IBTrACS_version4r01_Technical_Details.pdf
- **íŠ¹ì§•:** WMO ê³µì¸ Best Track í†µí•© ì•„ì¹´ì´ë¸Œ, ì—¬ëŸ¬ ê¸°ê´€ ë°ì´í„° í‘œì¤€í™”

### 8.6 KMA ë°ì´í„° ë° ì‹œë‚˜ë¦¬ì˜¤

**[KMA-1]** Korea Meteorological Administration, 2022: Algorithms for Determining Korea Meteorological Administration (KMA)'s Official Typhoon Best Tracks in the National Typhoon Center. Atmosphere, 32(3).
- **URL:** https://koreascience.kr/article/JAKO202200948197265.pub
- **Best Track ê²°ì • ì•Œê³ ë¦¬ì¦˜** ë° í’ˆì§ˆ ê´€ë¦¬ ì ˆì°¨

**[KMA-2]** KMA National Typhoon Center: Introduction on Typhoon Best Tracks of NTC/KMA.
- **URL:** https://www.typhooncommittee.org/19IWS/docs/Technical Presentations/5. Introduction on Typhoon Best Tracks of NTC_KMA.pdf
- **ë°ì´í„° í˜•ì‹:** ìœ„ì¹˜, ë“±ê¸‰, ê°•í’ë°˜ê²½(GALE, STORM) íƒ€ì›

**[KMA-3]** KMA Climate Information Portal: SSP Climate Projections.
- **URL:** http://www.climate.go.kr/home/Eng/htmls/intro/sub3.html
- **ì‹œë‚˜ë¦¬ì˜¤ í•´ìƒë„:**
  - SSP global scenario: 135 km (2019ë…„ 12ì›”~)
  - East Asia: 25 km (2020ë…„ 12ì›”~)
  - South Korea: 1 km (2021ë…„ 12ì›”~)

**[NIMS-1]** NIMS-KMA CMIP6: Climate Change Projection in the Twenty-First Century Simulated by NIMS-KMA CMIP6 Model Based on New GHGs Concentration Pathways.
- **URL:** https://climatemodeling.science.gov/research-highlights/climate-change-projection-twenty-first-century-simulated-nims-kma-cmip6-model
- **ëª¨ë¸:** K-ACE (KMA Advanced Community Earth system model), UKESM1 ensemble

### 8.7 ì¬ë¬´/ìœ„í—˜í‰ê°€ í‘œì¤€

**[TCFD-1]** TCFD, 2017: Recommendations of the Task Force on Climate-related Financial Disclosures. Financial Stability Board.
- **URL:** https://assets.bbhub.io/company/sites/60/2021/10/FINAL-2017-TCFD-Report.pdf
- **Official Site:** https://www.fsb-tcfd.org/
- **ë¬¼ë¦¬ì  ë¦¬ìŠ¤í¬:** ê·¹í•œ ê¸°ìƒ ì‚¬ê±´(íƒœí’ ë“±)ì˜ ì‹¬ê°ë„ ì¦ê°€ë¥¼ ê¸‰ì„± ë¦¬ìŠ¤í¬ë¡œ ë¶„ë¥˜

**[UNDRR-1]** UNDRR, 2015: Sendai Framework for Disaster Risk Reduction 2015-2030.
- **URL:** https://www.preventionweb.net/files/43291_sendaiframeworkfordrren.pdf
- **Target C:** 2030ë…„ê¹Œì§€ ì¬í•´ ì§ì ‘ ê²½ì œ ì†ì‹¤ì„ ì „ì§€êµ¬ GDP ëŒ€ë¹„ ê°ì†Œ
- **ì¬ì • ì†ì‹¤ í‰ê°€** ë°©ë²•ë¡  í”„ë ˆì„ì›Œí¬ ì œê³µ

### 8.8 ê¸°íƒ€ ì£¼ìš” ì—°êµ¬

**[BHATIA-1]** Bhatia, K.T., et al., 2019: Recent increases in tropical cyclone intensification rates. Nature Communications, 10, Article 635.
- **DOI:** 10.1038/s41467-019-08471-z
- **ë°œê²¬:** 1982-2009ë…„ ëŒ€ì„œì–‘ íƒœí’ ê¸‰ê²© ê°•í™”ìœ¨ì˜ ìœ ì˜ë¯¸í•œ ì¦ê°€ (ì¸ìœ„ì  ê°•ì œë ¥ ê¸°ì¸)

**[PATRICOLA-1]** Patricola, C.M. and Wehner, M.F., 2018: Anthropogenic influences on major tropical cyclone events. Nature, 563, 339-346.
- **DOI:** 10.1038/s41586-018-0673-2
- **ë°œê²¬:** ê¸°í›„ë³€í™”ê°€ Katrina, Irma, Mariaì˜ í‰ê· /ê·¹í•œ ê°•ìˆ˜ëŸ‰ì„ ì‚°ì—…í™” ì´ì „ ëŒ€ë¹„ ê°•í™”

**[HOLLAND-1]** Holland, G.J., 2008: A Revised Hurricane Pressure-Wind Model. Monthly Weather Review, 136, 3432-3445.
- **DOI:** 10.1175/2008MWR2395.1
- **ê¸°ì—¬:** ì¤‘ì‹¬ê¸°ì••-ìµœëŒ€í’ì† ê´€ê³„ì‹ ê°œì„  (ê°•ë„ ì¶”ì • ê°œì„ )

---

## ë¶€ë¡: ì½”ë“œ ìŠ¤ë‹ˆí« ì „ì²´

### A.1 ì „ì²´ ì›Œí¬í”Œë¡œìš°

```python
from pathlib import Path
import numpy as np

# === 1. ë°ì´í„° ì¤€ë¹„ ===
baseline_tracks = load_all_best_track_data("./typhoon/", range(2015, 2025))
site = {'lon': 127.38, 'lat': 36.35}

# === 2. Agent ì´ˆê¸°í™” ===
agent = TyphoonProbabilityAgent()
agent.initialize_baseline(baseline_tracks, site)

# === 3. KMA ë¡œë” ===
kma_loader = KMAScenarioDataLoader("./KMA/", site)

# === 4. 4ê°œ ì‹œë‚˜ë¦¬ì˜¤ AAL ===
results = calculate_all_scenarios_aal(
    baseline_tracks=baseline_tracks,
    site_location=site,
    kma_data_dir="./KMA/",
    periods=[(2021, 2040), (2041, 2060), (2061, 2100)]
)

# === 5. ê²°ê³¼ ì¶œë ¥ ===
for scenario in ['SSP126', 'SSP245', 'SSP370', 'SSP585']:
    print(f"\n{scenario}:")
    print(f"  ì „ì²´ AAL: {results[scenario]['aal']:.4f} ({results[scenario]['aal']*100:.2f}%)")
    for period_key, period_data in results[scenario]['periods'].items():
        print(f"    {period_key}: {period_data['aal']:.4f}")
```

### A.2 ë‹¨ì¼ ë…„ë„ AAL

```python
# 2050ë…„ SSP585 ì‹œë‚˜ë¦¬ì˜¤ AAL
result_2050 = agent.calculate_probability({
    'future_scenario': {
        'scenario': 'SSP585',
        'years': (2045, 2055),  # 2050 ì¤‘ì‹¬ 10ë…„ ìœˆë„ìš°
        'kma_data_loader': kma_loader,
        'site_location': site
    }
})

aal_2050 = sum(
    p * dr
    for p, dr in zip(
        result_2050['bin_probabilities'],
        result_2050['bin_base_damage_rates']
    )
)

print(f"2050ë…„ ì˜ˆìƒ AAL (SSP585): {aal_2050:.4f}")
```

---

**ë¬¸ì„œ ë²„ì „**: 3.0 (ë‹¨ì¼ ëª…í™• ë¡œì§)
**ìµœì¢… ìˆ˜ì •ì¼**: 2025-11-23
**ë³€ê²½ ì´ë ¥**:
- v1.0: ì´ˆê¸° ì‘ì„±
- v2.0: ê³¼í•™ì  ê·¼ê±° ë³´ê°• (30+ ë ˆí¼ëŸ°ìŠ¤)
- v2.1: ì‹¤ì œ ì‚¬ìš© ê°€ëŠ¥í•œ KMA ë°ì´í„°ë§Œ ë°˜ì˜
- v3.0: ëª¨í˜¸í•œ í‘œí˜„ ì œê±°, ê¸°ì˜¨(TA) ë‹¨ì¼ ë³€ìˆ˜ ìŠ¤ì¼€ì¼ë§ìœ¼ë¡œ ëª…í™•í™”
